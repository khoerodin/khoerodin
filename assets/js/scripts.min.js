!function(){"use strict";var e=document,g=window,k=e.createElement("div"),l=Array.prototype,m=l.filter,n=l.indexOf,aa=l.map,q=l.push,r=l.reverse,u=l.slice,v=l.some,ba=l.splice,ca=/^#[\w-]*$/,da=/^\.[\w-]*$/,ea=/<.+>/,fa=/^\w+$/;function x(t,n){return void 0===n&&(n=e),n&&9===n.nodeType||n&&1===n.nodeType?da.test(t)?n.getElementsByClassName(t.slice(1)):fa.test(t)?n.getElementsByTagName(t):n.querySelectorAll(t):[]}var y=(f.prototype.init=function(t,e){return new f(t,e)},f),C=y.prototype.init;function f(t,n){if(void 0===n&&(n=e),t){if(t instanceof y)return t;var r=t;if(z(t)){if(r=n instanceof y?n[0]:n,!(r=ca.test(t)?r.getElementById(t.slice(1)):ea.test(t)?A(t):x(t,r)))return}else if(B(t))return this.ready(t);for(!r.nodeType&&r!==g||(r=[r]),this.length=r.length,t=0,n=this.length;t<n;t++)this[t]=r[t]}}C.fn=C.prototype=y.prototype,y.prototype.length=0,y.prototype.splice=ba,"function"==typeof Symbol&&(y.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator]),y.prototype.get=function(t){return void 0===t?u.call(this):this[t<0?t+this.length:t]},y.prototype.eq=function(t){return C(this.get(t))},y.prototype.first=function(){return this.eq(0)},y.prototype.last=function(){return this.eq(-1)},y.prototype.map=function(n){return C(aa.call(this,function(t,e){return n.call(t,e,t)}))},y.prototype.slice=function(){return C(u.apply(this,arguments))};var ha=/-([a-z])/g;function ia(t,e){return e.toUpperCase()}function D(t){return t.replace(ha,ia)}function E(t,e){for(var n=0,r=t.length;n<r&&!1!==e.call(t[n],n,t[n]);n++);}function F(t){for(var e=1;e<arguments.length;e++);for(var n=(e=arguments).length,r=n<2?0:1;r<n;r++)for(var i in e[r])t[i]=e[r][i];return t}function G(t,e){var n=t&&(t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector);return!!n&&n.call(t,e)}function H(t,e,n){for(var r=[],i=0,o=t.length;i<o;i++)for(var a=t[i][e];null!=a&&(r.push(a),n);)a=a[e];return r}function I(t){return!!t&&t===t.window}function B(t){return"function"==typeof t}function z(t){return"string"==typeof t}function J(t){return!isNaN(parseFloat(t))&&isFinite(t)}C.camelCase=D,C.each=E,y.prototype.each=function(t){return E(this,t),this},y.prototype.removeProp=function(n){return this.each(function(t,e){delete e[n]})},y.prototype.extend=function(t){return F(C.fn,t)},C.extend=F,C.guid=1,C.matches=G;var K=Array.isArray;function L(n){return z(n)?function(t,e){return G(e,n)}:B(n)?n:n instanceof y?function(t,e){return n.is(e)}:function(t,e){return e===n}}function M(t,e){return e&&t.length?t.filter(e):t}C.isWindow=I,C.isFunction=B,C.isString=z,C.isNumeric=J,C.isArray=K,y.prototype.prop=function(n,r){if(n){if(z(n))return arguments.length<2?this[0]&&this[0][n]:this.each(function(t,e){e[n]=r});for(var t in n)this.prop(t,n[t]);return this}},y.prototype.filter=function(t){if(!t)return C();var n=L(t);return C(m.call(this,function(t,e){return n.call(t,e,t)}))};var ja=/\S+/g;function N(t){return z(t)&&t.match(ja)||[]}function O(t){return 1<t.length?m.call(t,function(t,e,r){return n.call(r,t)===e}):t}function P(t,e,n){if(t&&1===t.nodeType&&e)return t=g.getComputedStyle(t,null),e?n?t.getPropertyValue(e)||void 0:t[e]:t}function Q(t,e){return parseInt(P(t,e),10)||0}y.prototype.hasClass=function(e){return e&&v.call(this,function(t){return t.classList.contains(e)})},y.prototype.removeAttr=function(t){var e=N(t);return e.length?this.each(function(t,n){E(e,function(t,e){n.removeAttribute(e)})}):this},y.prototype.attr=function(n,r){if(n){if(z(n)){if(arguments.length<2){if(!this[0])return;var t=this[0].getAttribute(n);return null===t?void 0:t}return void 0===r?this:null===r?this.removeAttr(n):this.each(function(t,e){e.setAttribute(n,r)})}for(t in n)this.attr(t,n[t]);return this}},y.prototype.toggleClass=function(t,r){var e=N(t),i=void 0!==r;return e.length?this.each(function(t,n){E(e,function(t,e){i?r?n.classList.add(e):n.classList.remove(e):n.classList.toggle(e)})}):this},y.prototype.addClass=function(t){return this.toggleClass(t,!0)},y.prototype.removeClass=function(t){return arguments.length?this.toggleClass(t,!1):this.attr("class","")},C.unique=O,y.prototype.add=function(t,e){return C(O(this.get().concat(C(t,e).get())))};var R=/^--/,S={},ka=k.style,la=["webkit","moz","ms","o"];function ma(n,t){if(void 0===t&&(t=R.test(n)),t)return n;if(!S[n]){var e=""+(t=D(n)).charAt(0).toUpperCase()+t.slice(1);E(t=(t+" "+la.join(e+" ")+e).split(" "),function(t,e){if(e in ka)return S[n]=e,!1})}return S[n]}C.prefixedProp=ma;var na={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function oa(t,e,n){return void 0===n&&(n=R.test(t)),n||na[t]||!J(e)?e:e+"px"}function pa(t,e){t=t.dataset?t.dataset[e]||t.dataset[D(e)]:t.getAttribute("data-"+e);try{return JSON.parse(t)}catch(t){}return t}y.prototype.css=function(n,r){if(z(n)){var i=R.test(n);return n=ma(n,i),arguments.length<2?this[0]&&P(this[0],n,i):n?(r=oa(n,r,i),this.each(function(t,e){e&&1===e.nodeType&&(i?e.style.setProperty(n,r):e.style[n]=r)})):this}for(var t in n)this.css(t,n[t]);return this};var qa=/^data-(.+)/;function ra(t,e){return Q(t,"border"+(e?"Left":"Top")+"Width")+Q(t,"padding"+(e?"Left":"Top"))+Q(t,"padding"+(e?"Right":"Bottom"))+Q(t,"border"+(e?"Right":"Bottom")+"Width")}y.prototype.data=function(n,r){var i=this;if(!n){if(!this[0])return;var o={};return E(this[0].attributes,function(t,e){(t=e.name.match(qa))&&(o[t[1]]=i.data(t[1]))}),o}if(z(n))return void 0===r?this[0]&&pa(this[0],n):this.each(function(t,e){t=r;try{t=JSON.stringify(t)}catch(t){}e.dataset?e.dataset[D(n)]=t:e.setAttribute("data-"+n,t)});for(var t in n)this.data(t,n[t]);return this},E(["Width","Height"],function(t,e){y.prototype["inner"+e]=function(){if(this[0])return I(this[0])?g["inner"+e]:this[0]["client"+e]}}),E(["width","height"],function(r,i){y.prototype[i]=function(t){if(!this[0])return void 0===t?void 0:this;if(!arguments.length)return I(this[0])?this[0][D("outer-"+i)]:this[0].getBoundingClientRect()[i]-ra(this[0],!r);var n=parseInt(t,10);return this.each(function(t,e){e&&1===e.nodeType&&(t=P(e,"boxSizing"),e.style[i]=oa(i,n+("border-box"===t?ra(e,!r):0)))})}}),E(["Width","Height"],function(e,n){y.prototype["outer"+n]=function(t){if(this[0])return I(this[0])?g["outer"+n]:this[0]["offset"+n]+(t?Q(this[0],"margin"+(e?"Top":"Left"))+Q(this[0],"margin"+(e?"Bottom":"Right")):0)}});var T={};function sa(e,t){return!t||!v.call(t,function(t){return e.indexOf(t)<0})}y.prototype.toggle=function(o){return this.each(function(t,n){if(void 0!==o?o:"none"===P(n,"display")){if(n.style.display="","none"===P(n,"display")){if(t=n.style,n=n.tagName,T[n])n=T[n];else{var r=e.createElement(n);e.body.appendChild(r);var i=P(r,"display");e.body.removeChild(r),n=T[n]="none"!==i?i:"block"}t.display=n}}else n.style.display="none"})},y.prototype.hide=function(){return this.toggle(!1)},y.prototype.show=function(){return this.toggle(!0)};var U={focus:"focusin",blur:"focusout"},ta={mouseenter:"mouseover",mouseleave:"mouseout"},ua=/^(?:mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function va(t,e,n,r,i){i.guid=i.guid||C.guid++;var o=t.__cashEvents=t.__cashEvents||{};o[e]=o[e]||[],o[e].push([n,r,i]),t.addEventListener(e,i)}function V(t){return[(t=t.split("."))[0],t.slice(1).sort()]}function W(r,i,o,a,u){var t=r.__cashEvents=r.__cashEvents||{};if(i)t[i]&&(t[i]=t[i].filter(function(t){var e=t[0],n=t[1];if(t=t[2],u&&t.guid!==u.guid||!sa(e,o)||a&&a!==n)return!0;r.removeEventListener(i,t)}));else{for(i in t)W(r,i,o,a,u);delete r.__cashEvents}}function wa(t){return t.multiple?H(m.call(t.options,function(t){return t.selected&&!t.disabled&&!t.parentNode.disabled}),"value"):t.value||""}y.prototype.off=function(t,i,o){var a=this;return void 0===t?this.each(function(t,e){return W(e)}):(B(i)&&(o=i,i=""),E(N(t),function(t,e){var n=(t=V(ta[e]||U[e]||e))[0],r=t[1];a.each(function(t,e){return W(e,n,r,i,o)})})),this},y.prototype.on=function(t,u,s,c){var n=this;if(z(t))return B(u)&&(s=u,u=""),E(N(t),function(t,e){var o=(t=V(ta[e]||U[e]||e))[0],a=t[1];n.each(function(t,i){(t=function t(e){if(!e.namespace||sa(a,e.namespace.split("."))){var n=i;if(u){for(var r=e.target;!G(r,u);){if(r===i)return;if(!(r=r.parentNode))return}n=r,e.__delegate=!0}e.__delegate&&Object.defineProperty(e,"currentTarget",{configurable:!0,get:function(){return n}}),r=s.call(n,e,e.data),c&&W(i,o,a,u,t),!1===r&&(e.preventDefault(),e.stopPropagation())}}).guid=s.guid=s.guid||C.guid++,va(i,o,a,u,t)})}),this;for(var e in t)this.on(e,u,t[e]);return this},y.prototype.one=function(t,e,n){return this.on(t,e,n,!0)},y.prototype.ready=function(t){function n(){return t(C)}return"loading"!==e.readyState?setTimeout(n):e.addEventListener("DOMContentLoaded",n),this},y.prototype.trigger=function(t,n){if(z(t)){var r=V(t);t=r[0],r=r[1];var i=ua.test(t)?"MouseEvents":"HTMLEvents",o=e.createEvent(i);o.initEvent(t,!0,!0),o.namespace=r.join(".")}else o=t;o.data=n;var a=o.type in U;return this.each(function(t,e){a&&B(e[o.type])?e[o.type]():e.dispatchEvent(o)})};var xa=/%20/g,Aa=/file|reset|submit|button|image/i,Ba=/radio|checkbox/i;y.prototype.serialize=function(){var r="";return this.each(function(t,e){E(e.elements||[e],function(t,n){n.disabled||!n.name||"FIELDSET"===n.tagName||Aa.test(n.type)||Ba.test(n.type)&&!n.checked||void 0!==(t=wa(n))&&E(t=K(t)?t:[t],function(t,e){t=r,e="&"+encodeURIComponent(n.name)+"="+encodeURIComponent(e).replace(xa,"+"),r=t+e})})}),r.substr(1)},y.prototype.val=function(r){return void 0===r?this[0]&&wa(this[0]):this.each(function(t,e){if("SELECT"===e.tagName){var n=K(r)?r:null===r?[]:[r];E(e.options,function(t,e){e.selected=0<=n.indexOf(e.value)})}else e.value=null===r?"":r})},y.prototype.clone=function(){return this.map(function(t,e){return e.cloneNode(!0)})},y.prototype.detach=function(){return this.each(function(t,e){e.parentNode&&e.parentNode.removeChild(e)})};var Ca=/^\s*<(\w+)[^>]*>/,Da=/^\s*<(\w+)\s*\/?>(?:<\/\1>)?\s*$/,X;function A(t){if(!X){var n=e.createElement("table"),r=e.createElement("tr");X={"*":k,tr:e.createElement("tbody"),td:r,th:r,thead:n,tbody:n,tfoot:n}}return z(t)?Da.test(t)?[e.createElement(RegExp.$1)]:(n=Ca.test(t)&&RegExp.$1,(n=X[n]||X["*"]).innerHTML=t,C(n.childNodes).detach().get()):[]}C.parseHTML=A,y.prototype.empty=function(){return this.each(function(t,e){for(;e.firstChild;)e.removeChild(e.firstChild)})},y.prototype.html=function(n){return void 0===n?this[0]&&this[0].innerHTML:this.each(function(t,e){e.innerHTML=n})},y.prototype.remove=function(){return this.detach().off()},y.prototype.text=function(n){return void 0===n?this[0]?this[0].textContent:"":this.each(function(t,e){e.textContent=n})},y.prototype.unwrap=function(){return this.parent().each(function(t,e){(t=C(e)).replaceWith(t.children())}),this};var Ea=e.documentElement;y.prototype.offset=function(){var t=this[0];if(t)return{top:(t=t.getBoundingClientRect()).top+g.pageYOffset-Ea.clientTop,left:t.left+g.pageXOffset-Ea.clientLeft}},y.prototype.offsetParent=function(){return C(this[0]&&this[0].offsetParent)},y.prototype.position=function(){var t=this[0];if(t)return{left:t.offsetLeft,top:t.offsetTop}},y.prototype.children=function(t){var n=[];return this.each(function(t,e){q.apply(n,e.children)}),M(C(O(n)),t)},y.prototype.contents=function(){var n=[];return this.each(function(t,e){q.apply(n,"IFRAME"===e.tagName?[e.contentDocument]:e.childNodes)}),C(O(n))},y.prototype.find=function(t){for(var e=[],n=0,r=this.length;n<r;n++){var i=x(t,this[n]);i.length&&q.apply(e,i)}return C(O(e))};var Fa=/^$|^module$|\/(?:java|ecma)script/i,Ga=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Y(a){a=C(a),a.filter("script").add(a.find("script")).each(function(a,c){!c.src&&Fa.test(c.type)&&c.ownerDocument.documentElement.contains(c)&&eval(c.textContent.replace(Ga,""))})}function Z(t,e,i){E(t,function(n,r){E(e,function(t,e){t=n?e.cloneNode(!0):e,i?r.insertBefore(t,i&&r.firstChild):r.appendChild(t),Y(t)})})}y.prototype.append=function(){var n=this;return E(arguments,function(t,e){Z(n,C(e))}),this},y.prototype.appendTo=function(t){return Z(C(t),this),this},y.prototype.insertAfter=function(t){var e=this;return C(t).each(function(n,r){var i=r.parentNode;i&&e.each(function(t,e){t=n?e.cloneNode(!0):e,i.insertBefore(t,r.nextSibling),Y(t)})}),this},y.prototype.after=function(){var n=this;return E(r.apply(arguments),function(t,e){r.apply(C(e).slice()).insertAfter(n)}),this},y.prototype.insertBefore=function(t){var e=this;return C(t).each(function(n,r){var i=r.parentNode;i&&e.each(function(t,e){t=n?e.cloneNode(!0):e,i.insertBefore(t,r),Y(t)})}),this},y.prototype.before=function(){var n=this;return E(arguments,function(t,e){C(e).insertBefore(n)}),this},y.prototype.prepend=function(){var n=this;return E(arguments,function(t,e){Z(n,C(e),!0)}),this},y.prototype.prependTo=function(t){return Z(C(t),r.apply(this.slice()),!0),this},y.prototype.replaceWith=function(t){return this.before(t).remove()},y.prototype.replaceAll=function(t){return C(t).replaceWith(this),this},y.prototype.wrapAll=function(t){if(this[0]){for(t=C(t),this.first().before(t),t=t[0];t.children.length;)t=t.firstElementChild;this.appendTo(t)}return this},y.prototype.wrap=function(r){return this.each(function(t,e){var n=C(r)[0];C(e).wrapAll(t?n.cloneNode(!0):n)})},y.prototype.wrapInner=function(n){return this.each(function(t,e){(e=(t=C(e)).contents()).length?e.wrapAll(n):t.append(n)})},y.prototype.has=function(n){var t=z(n)?function(t,e){return!!x(n,e).length}:function(t,e){return e.contains(n)};return this.filter(t)},y.prototype.is=function(t){if(!t||!this[0])return!1;var n=L(t),r=!1;return this.each(function(t,e){return!(r=n.call(e,t,e))}),r},y.prototype.next=function(t,e){return M(C(O(H(this,"nextElementSibling",e))),t)},y.prototype.nextAll=function(t){return this.next(t,!0)},y.prototype.not=function(t){if(!t||!this[0])return this;var n=L(t);return this.filter(function(t,e){return!n.call(e,t,e)})},y.prototype.parent=function(t){return M(C(O(H(this,"parentNode"))),t)},y.prototype.index=function(t){var e=t?C(t)[0]:this[0];return t=t?this:C(e).parent().children(),n.call(t,e)},y.prototype.closest=function(t){if(!t||!this[0])return C();var e=this.filter(t);return e.length?e:this.parent().closest(t)},y.prototype.parents=function(t){return M(C(O(H(this,"parentElement",!0))),t)},y.prototype.prev=function(t,e){return M(C(O(H(this,"previousElementSibling",e))),t)},y.prototype.prevAll=function(t){return this.prev(t,!0)},y.prototype.siblings=function(t){var e=[];return this.each(function(t,n){q.apply(e,C(n).parent().children(function(t,e){return e!==n}))}),M(C(O(e)),t)},"undefined"!=typeof exports?module.exports=C:g.cash=g.$=C}();
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.senna={})}(this,function(e){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e};function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:o(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var u=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function l(e){return void 0!==e}function c(e){var t=void 0===e?"undefined":n(e);return"object"===t&&null!==e||"function"===t}function h(e){return"string"==typeof e||e instanceof String}function f(e){var t=0<arguments.length&&void 0!==e?e:{checkEnv:!0},n="undefined"!=typeof process&&!process.browser;return n&&t.checkEnv&&(n=void 0!==process.env&&"test"!==process.env.NODE_ENV),n}var v=(t(d,null,[{key:"equal",value:function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},{key:"firstDefinedValue",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t])return e[t]}},{key:"flatten",value:function(e,t){for(var n=1<arguments.length&&void 0!==t?t:[],r=0;r<e.length;r++)Array.isArray(e[r])?d.flatten(e[r],n):n.push(e[r]);return n}},{key:"remove",value:function(e,t){var n,r=e.indexOf(t);return(n=0<=r)&&d.removeAt(e,r),n}},{key:"removeAt",value:function(e,t){return 1===Array.prototype.splice.call(e,t,1).length}},{key:"slice",value:function(e,t,n){for(var r=2<arguments.length&&void 0!==n?n:e.length,i=[],a=t;a<r;a++)i.push(e[a]);return i}}]),d);function d(){a(this,d)}var p={throwException:function(e){p.nextTick(function(){throw e})},run:function(e,t){p.run.workQueueScheduled_||(p.nextTick(p.run.processWorkQueue),p.run.workQueueScheduled_=!0),p.run.workQueue_.push(new p.run.WorkItem_(e,t))}};p.run.workQueueScheduled_=!1,p.run.workQueue_=[],p.run.processWorkQueue=function(){for(;p.run.workQueue_.length;){var e=p.run.workQueue_;p.run.workQueue_=[];for(var t=0;t<e.length;t++){var n=e[t];try{n.fn.call(n.scope)}catch(e){p.throwException(e)}}}p.run.workQueueScheduled_=!1},p.run.WorkItem_=function(e,t){this.fn=e,this.scope=t},p.nextTick=function(e,t){var n=e;t&&(n=e.bind(t)),n=p.nextTick.wrapCallback_(n),p.nextTick.setImmediate_||("function"==typeof setImmediate&&f({checkEnv:!1})?p.nextTick.setImmediate_=setImmediate:p.nextTick.setImmediate_=p.nextTick.getSetImmediateEmulator_()),p.nextTick.setImmediate_(n)},p.nextTick.setImmediate_=null,p.nextTick.getSetImmediateEmulator_=function(){var e=void 0;if("function"==typeof MessageChannel&&(e=MessageChannel),void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(e=function(){var e=document.createElement("iframe");e.style.display="none",e.src="",e.title="",document.documentElement.appendChild(e);var t=e.contentWindow,n=t.document;n.open(),n.write(""),n.close();var r="callImmediate"+Math.random(),i=t.location.protocol+"//"+t.location.host,a=function(e){e.origin!==i&&e.data!==r||this.port1.onmessage()}.bind(this);t.addEventListener("message",a,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(r,i)}}}),void 0===e)return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(e){var t=document.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){setTimeout(e,0)};var t=new e,n={},r=n;return t.port1.onmessage=function(){var e=(n=n.next).cb;n.cb=null,e()},function(e){r.next={cb:e},r=r.next,t.port2.postMessage(0)}},p.nextTick.wrapCallback_=function(e){return e};var y=(t(m,[{key:"dispose",value:function(){this.disposed_||(this.disposeInternal(),this.disposed_=!0)}},{key:"disposeInternal",value:function(){}},{key:"isDisposed",value:function(){return this.disposed_}}]),m);function m(){a(this,m),this.disposed_=!1}t(g,null,[{key:"mixin",value:function(e){for(var t=void 0,n=void 0,r=arguments.length,i=Array(1<r?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];for(var o=0;o<i.length;o++)for(t in n=i[o])e[t]=n[t];return e}},{key:"getObjectByName",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:window;return e.split(".").reduce(function(e,t){return e[t]},n)}},{key:"map",value:function(e,t){for(var n={},r=Object.keys(e),i=0;i<r.length;i++)n[r[i]]=t(r[i],e[r[i]]);return n}},{key:"shallowEqual",value:function(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(e[n[i]]!==t[n[i]])return!1;return!0}}]);function g(){a(this,g)}var _=(t(k,null,[{key:"caseInsensitiveCompare",value:function(e,t){var n=String(e).toLowerCase(),r=String(t).toLowerCase();return n<r?-1:n===r?0:1}},{key:"collapseBreakingSpaces",value:function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}},{key:"escapeRegex",value:function(e){return String(e).replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}},{key:"getRandomString",value:function(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^Date.now()).toString(36)}},{key:"hashCode",value:function(e){for(var t=0,n=0,r=e.length;n<r;n++)t=31*t+e.charCodeAt(n),t%=4294967296;return t}},{key:"replaceInterval",value:function(e,t,n,r){return e.substring(0,t)+r+e.substring(n)}}]),k);function k(){a(this,k)}var E="__metal_data__",S=(t(b,null,[{key:"get",value:function(e,t,n){return e[E]||(e[E]={}),t?(!l(e[E][t])&&l(n)&&(e[E][t]=n),e[E][t]):e[E]}},{key:"has",value:function(e){return!!e[E]}},{key:"set",value:function(e,t,n){return e[E]||(e[E]={}),t&&l(n)?(e[E][t]=n,e[E][t]):e[E]}}]),b);function b(){a(this,b)}var P=(i(w,y),t(w,[{key:"disposeInternal",value:function(){this.removeListener(),this.emitter_=null,this.listener_=null}},{key:"removeListener",value:function(){this.emitter_.isDisposed()||this.emitter_.removeListener(this.event_,this.listener_)}}]),w);function w(e,t,n){a(this,w);var r=s(this,(w.__proto__||Object.getPrototypeOf(w)).call(this));return r.emitter_=e,r.event_=t,r.listener_=n,r}var A=[0];i(L,y),t(L,[{key:"addHandler_",value:function(e,t){return e?(Array.isArray(e)||(e=[e]),e.push(t)):e=t,e}},{key:"addListener",value:function(e,t,n){this.validateListener_(t);for(var r=this.toEventsArray_(e),i=0;i<r.length;i++)this.addSingleListener_(r[i],t,n);return new P(this,e,t)}},{key:"addSingleListener_",value:function(e,t,n,r){this.runListenerHandlers_(e),(n||r)&&(t={default:n,fn:t,origin:r}),this.events_=this.events_||{},this.events_[e]=this.addHandler_(this.events_[e],t)}},{key:"buildFacade_",value:function(e){if(this.getShouldUseFacade()){var t={preventDefault:function(){t.preventedDefault=!0},target:this,type:e};return t}}},{key:"disposeInternal",value:function(){this.events_=null}},{key:"emit",value:function(e){var t=this.getRawListeners_(e);if(0===t.length)return!1;var n=v.slice(arguments,1);return this.runListeners_(t,n,this.buildFacade_(e)),!0}},{key:"getRawListeners_",value:function(e){return T(this.events_&&this.events_[e]).concat(T(this.events_&&this.events_["*"]))}},{key:"getShouldUseFacade",value:function(){return this.shouldUseFacade_}},{key:"listeners",value:function(e){return this.getRawListeners_(e).map(function(e){return e.fn?e.fn:e})}},{key:"many",value:function(e,t,n){for(var r=this.toEventsArray_(e),i=0;i<r.length;i++)this.many_(r[i],t,n);return new P(this,e,n)}},{key:"many_",value:function(t,n,r){var i=this;n<=0||i.addSingleListener_(t,function e(){0==--n&&i.removeListener(t,e),r.apply(i,arguments)},!1,r)}},{key:"matchesListener_",value:function(e,t){return(e.fn||e)===t||e.origin&&e.origin===t}},{key:"off",value:function(e,t){if(this.validateListener_(t),!this.events_)return this;for(var n=this.toEventsArray_(e),r=0;r<n.length;r++)this.events_[n[r]]=this.removeMatchingListenerObjs_(T(this.events_[n[r]]),t);return this}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"onListener",value:function(e){this.listenerHandlers_=this.addHandler_(this.listenerHandlers_,e)}},{key:"once",value:function(e,t){return this.many(e,1,t)}},{key:"removeAllListeners",value:function(e){if(this.events_)if(e)for(var t=this.toEventsArray_(e),n=0;n<t.length;n++)this.events_[t[n]]=null;else this.events_=null;return this}},{key:"removeMatchingListenerObjs_",value:function(e,t){for(var n=[],r=0;r<e.length;r++)this.matchesListener_(e[r],t)||n.push(e[r]);return 0<n.length?n:null}},{key:"removeListener",value:function(){return this.off.apply(this,arguments)}},{key:"runListenerHandlers_",value:function(e){var t=this.listenerHandlers_;if(t){t=T(t);for(var n=0;n<t.length;n++)t[n](e)}}},{key:"runListeners_",value:function(e,t,n){n&&t.push(n);for(var r=[],i=0;i<e.length;i++){var a=e[i].fn||e[i];e[i].default?r.push(a):a.apply(this,t)}if(!n||!n.preventedDefault)for(var o=0;o<r.length;o++)r[o].apply(this,t)}},{key:"setShouldUseFacade",value:function(e){return this.shouldUseFacade_=e,this}},{key:"toEventsArray_",value:function(e){return h(e)&&(A[0]=e,e=A),e}},{key:"validateListener_",value:function(e){if(!function(e){return"function"==typeof e}(e))throw new TypeError("Listener must be a function")}}]);function L(){a(this,L);var e=s(this,(L.__proto__||Object.getPrototypeOf(L)).call(this));return e.events_=null,e.listenerHandlers_=null,e.shouldUseFacade_=!1,e}function T(e){return e=e||[],Array.isArray(e)?e:[e]}var C=(i(O,y),t(O,[{key:"addListener_",value:function(e,t){return this.originEmitter_.on(e,t)}},{key:"disposeInternal",value:function(){this.removeListeners_(),this.proxiedEvents_=null,this.originEmitter_=null,this.targetEmitter_=null}},{key:"emitOnTarget_",value:function(){var e;(e=this.targetEmitter_).emit.apply(e,arguments)}},{key:"proxyEvent",value:function(e){this.shouldProxyEvent_(e)&&this.tryToAddListener_(e)}},{key:"removeListeners_",value:function(){if(this.proxiedEvents_){for(var e=Object.keys(this.proxiedEvents_),t=0;t<e.length;t++)this.proxiedEvents_[e[t]].removeListener();this.proxiedEvents_=null}this.pendingEvents_=null}},{key:"setOriginEmitter",value:function(e){var t=this,n=this.originEmitter_&&this.proxiedEvents_?Object.keys(this.proxiedEvents_):this.pendingEvents_;this.originEmitter_=e,n&&(this.removeListeners_(),n.forEach(function(e){return t.proxyEvent(e)}))}},{key:"shouldProxyEvent_",value:function(e){return!(this.whitelist_&&!this.whitelist_[e]||this.blacklist_&&this.blacklist_[e]||this.proxiedEvents_&&this.proxiedEvents_[e])}},{key:"startProxy_",value:function(){this.targetEmitter_.onListener(this.proxyEvent.bind(this))}},{key:"tryToAddListener_",value:function(e){this.originEmitter_?(this.proxiedEvents_=this.proxiedEvents_||{},this.proxiedEvents_[e]=this.addListener_(e,this.emitOnTarget_.bind(this,e))):(this.pendingEvents_=this.pendingEvents_||[],this.pendingEvents_.push(e))}}]),O);function O(e,t,n,r){a(this,O);var i=s(this,(O.__proto__||Object.getPrototypeOf(O)).call(this));return i.blacklist_=n,i.originEmitter_=e,i.pendingEvents_=null,i.proxiedEvents_=null,i.targetEmitter_=t,i.whitelist_=r,i.startProxy_(),i}i(R,y),t(R,[{key:"add",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<arguments.length;r++)this.eventHandles_.push(t[r])}},{key:"disposeInternal",value:function(){this.eventHandles_=null}},{key:"removeAllListeners",value:function(){for(var e=0;e<this.eventHandles_.length;e++)this.eventHandles_[e].removeListener();this.eventHandles_=[]}}]);function R(){a(this,R);var e=s(this,(R.__proto__||Object.getPrototypeOf(R)).call(this));return e.eventHandles_=[],e}var N=(i(H,P),t(H,[{key:"removeListener",value:function(){var e=S.get(this.emitter_,"delegating",{}),t=S.get(this.emitter_,"listeners",{}),n=this.selector_,r=h(n)?e[this.event_].selectors:t,i=h(n)?n:this.event_;v.remove(r[i]||[],this.listener_),r[i]&&0===r[i].length&&delete r[i]}}]),H);function H(e,t,n,r){a(this,H);var i=s(this,(H.__proto__||Object.getPrototypeOf(H)).call(this,e,t,n));return i.selector_=r,i}var I=(i(x,P),t(x,[{key:"removeListener",value:function(){this.emitter_.removeEventListener(this.event_,this.listener_,this.capture_)}}]),x);function x(e,t,n,r){a(this,x);var i=s(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,e,t,n));return i.capture_=r,i}var D={},U={},F={},M="__metal_last_container__",j={blur:!0,error:!0,focus:!0,invalid:!0,load:!0,scroll:!0};function q(t,e){e.split(" ").forEach(function(e){e&&t.classList.add(e)})}function B(e,t){var n=" "+e.className+" ",r="";t=t.split(" ");for(var i=0;i<t.length;i++){var a=t[i];-1===n.indexOf(" "+a+" ")&&(r+=" "+a)}r&&(e.className=e.className+r)}function Q(e,t,n){e[t]||(e[t]=[]),e[t].push(n)}function V(e,t){if(h(t)&&(t=W(t)),function(e){return function(e){return l(e)&&!function(e){return null===e}(e)}(e)&&"number"==typeof e.length&&"function"==typeof e.item}(t))for(var n=Array.prototype.slice.call(t),r=0;r<n.length;r++)e.appendChild(n[r]);else e.appendChild(t);return t}function W(e){var t=document.createElement("div");t.innerHTML="<br>"+e,t.removeChild(t.firstChild);for(var n=document.createDocumentFragment();t.firstChild;)n.appendChild(t.firstChild);return n}function z(e,t){return function(e){return e&&"object"===(void 0===e?"undefined":n(e))&&9===e.nodeType}(e)?e.documentElement.contains(t):e.contains(t)}function X(e,t,n,r,i){var a=F[t];return a&&a.delegate&&(t=a.originalEvent,r=a.handler.bind(a,r)),i&&((r=r.bind()).defaultListener_=!0),function(e,t){var n=S.get(e,"delegating",{});n[t]||(n[t]={handle:J(e,t,G,!!j[t]),selectors:{}})}(e,t),h(n)?function(e,t,n,r){Q(S.get(e,"delegating",{})[t].selectors,n,r)}(e,t,n,r):function(e,t,n){Q(S.get(e,"listeners",{}),t,n)}(n,t,r),new N(h(n)?e:n,t,r,h(n)?n:null)}function $(e,t,n){if(n&&"click"===t&&2===n.button)return!1;return!("click"===t&&-1<["BUTTON","INPUT","SELECT","TEXTAREA","FIELDSET"].indexOf(e.tagName))||!(e.disabled||function(e,t){return function(e,t){for(;e&&!K(e,t);)e=e.parentNode;return e}(e.parentNode,t)}(e,"fieldset[disabled]"))}function Y(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function G(e){!function(e){e.stopPropagation=ie,e.stopImmediatePropagation=re}(e);var t=!0,n=e.currentTarget,r=[];return t&=function(e,t,n){var r=!0,i=t.target,a=e.parentNode;for(;i&&i!==a&&!t.stopped;)$(i,t.type,t)&&(t.delegateTarget=i,r&=ae(i,t,n),r&=se(e,i,t,n)),i=i.parentNode;return r}(n,e,r),t&=function(e,t){for(var n=!0,r=0;r<e.length&&!t.defaultPrevented;r++)t.delegateTarget=e[r].element,n&=e[r].fn(t);return n}(r,e),e.delegateTarget=null,e[M]=n,t}function K(e,t){if(!e||1!==e.nodeType)return!1;var n=Element.prototype,r=n.matches||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return r?r.call(e,t):function(e,t){var n=e.parentNode;if(n)for(var r=n.querySelectorAll(t),i=0;i<r.length;++i)if(r[i]===e)return!0;return!1}(e,t)}function J(e,t,n,r){if(h(e))return X(document,t,e,n);var i=F[t];return i&&i.event&&(t=i.originalEvent,n=i.handler.bind(i,n)),e.addEventListener(t,n,r),new I(e,t,n,r)}function Z(e,t,n){var r=J(e,t,function(){return r.removeListener(),n.apply(this,arguments)});return r}function ee(e,t){F[e]=t}function te(t,e){e.split(" ").forEach(function(e){e&&t.classList.remove(e)})}function ne(e,t){var n=" "+e.className+" ";t=t.split(" ");for(var r=0;r<t.length;r++)n=n.replace(" "+t[r]+" "," ");e.className=n.trim()}function re(){this.stopped=!0,this.stoppedImmediate=!0,Event.prototype.stopImmediatePropagation.call(this)}function ie(){this.stopped=!0,Event.prototype.stopPropagation.call(this)}function ae(e,t,n){var r=t[M];return!(!l(r)||!z(r,e))||oe(S.get(e,"listeners",{})[t.type],t,e,n)}function oe(e,t,n,r){var i=!0;e=e||[];for(var a=0;a<e.length&&!t.stoppedImmediate;a++)e[a].defaultListener_?r.push({element:n,fn:e[a]}):i&=e[a](t);return i}function se(e,t,n,r){for(var i=!0,a=S.get(e,"delegating",{})[n.type].selectors,o=Object.keys(a),s=0;s<o.length&&!n.stoppedImmediate;s++){if(K(t,o[s]))i&=oe(a[o[s]],n,t,r)}return i}i(ue,C),t(ue,[{key:"addListener_",value:function(e,t){if(this.originEmitter_.addEventListener){if(this.isDelegateEvent_(e)){var n=e.indexOf(":",9),r=e.substring(9,n),i=e.substring(n+1);return X(this.originEmitter_,r,i,t)}return J(this.originEmitter_,e,t)}return o(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"addListener_",this).call(this,e,t)}},{key:"isDelegateEvent_",value:function(e){return"delegate:"===e.substr(0,9)}},{key:"isSupportedDomEvent_",value:function(e){return!this.originEmitter_||!this.originEmitter_.addEventListener||this.isDelegateEvent_(e)&&-1!==e.indexOf(":",9)||function(e,t){if(F[t])return!0;h(e)&&(D[e]||(D[e]=document.createElement(e)),e=D[e]);var n=e.tagName;return U[n]&&U[n].hasOwnProperty(t)||(U[n]=U[n]||{},U[n][t]="on"+t in e),U[n][t]}(this.originEmitter_,e)}},{key:"shouldProxyEvent_",value:function(e){return o(ue.prototype.__proto__||Object.getPrototypeOf(ue.prototype),"shouldProxyEvent_",this).call(this,e)&&this.isSupportedDomEvent_(e)}}]);function ue(){return a(this,ue),s(this,(ue.__proto__||Object.getPrototypeOf(ue)).apply(this,arguments))}var le=(t(ce,null,[{key:"checkAnimationEventName",value:function(){return void 0===ce.animationEventName_&&(ce.animationEventName_={animation:ce.checkAnimationEventName_("animation"),transition:ce.checkAnimationEventName_("transition")}),ce.animationEventName_}},{key:"checkAnimationEventName_",value:function(e){var t=["Webkit","MS","O",""],n=_.replaceInterval(e,0,1,e.substring(0,1).toUpperCase()),r=[n+"End",n+"End",n+"End",e+"end"];ce.animationElement_||(ce.animationElement_=document.createElement("div"));for(var i=0;i<t.length;i++)if(void 0!==ce.animationElement_.style[t[i]+n])return t[i].toLowerCase()+r[i];return e+"end"}},{key:"checkAttrOrderChange",value:function(){if(void 0===ce.attrOrderChange_){var e='<div data-component="" data-ref=""></div>',t=document.createElement("div");V(t,e),ce.attrOrderChange_=e!==t.innerHTML}return ce.attrOrderChange_}}]),ce);function ce(){a(this,ce)}le.animationElement_=void 0,le.animationEventName_=void 0,le.attrOrderChange_=void 0;var he=(t(fe,null,[{key:"run",value:function(e,t){var n=document.createElement("script");return n.text=e,t?t(n):document.head.appendChild(n),Y(n),n}},{key:"runFile",value:function(e,t,n){var r=document.createElement("script");function i(){Y(r),t&&t()}return r.src=e,Z(r,"load",i),Z(r,"error",i),n?n(r):document.head.appendChild(r),r}},{key:"runScript",value:function(e,t,n){function r(){t&&t()}if(!e.type||"text/javascript"===e.type)return Y(e),e.src?fe.runFile(e.src,t,n):(p.nextTick(r),fe.run(e.text,n));p.nextTick(r)}},{key:"runScriptsInElement",value:function(e,t,n){var r=e.querySelectorAll("script");r.length?fe.runScriptsInOrder(r,0,t,n):t&&p.nextTick(t)}},{key:"runScriptsInOrder",value:function(e,t,n,r){fe.runScript(e.item(t),function(){t<e.length-1?fe.runScriptsInOrder(e,t+1,n,r):n&&p.nextTick(n)},r)}}]),fe);function fe(){a(this,fe)}var ve=(t(de,null,[{key:"run",value:function(e,t){var n=document.createElement("style");return n.innerHTML=e,t?t(n):document.head.appendChild(n),n}},{key:"runFile",value:function(e,t,n){var r=document.createElement("link");return r.rel="stylesheet",r.href=e,de.runStyle(r,t,n),r}},{key:"runStyle",value:function(e,t,n){function r(){t&&t()}if(!e.rel||"stylesheet"===e.rel||"canonical"===e.rel||"alternate"===e.rel)return"STYLE"===e.tagName||"canonical"===e.rel||"alternate"===e.rel?p.nextTick(r):(Z(e,"load",r),Z(e,"error",r)),n?n(e):document.head.appendChild(e),e;p.nextTick(r)}},{key:"runStylesInElement",value:function(e,t,n){var r=e.querySelectorAll("style,link");if(0===r.length&&t)p.nextTick(t);else for(var i=0,a=function(){t&&++i===r.length&&p.nextTick(t)},o=0;o<r.length;o++)de.runStyle(r[o],a,n)}}]),de);function de(){a(this,de)}f()||function(){var e={mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"};Object.keys(e).forEach(function(i){ee(i,{delegate:!0,handler:function(e,t){var n=t.relatedTarget,r=t.delegateTarget;if(!n||n!==r&&!z(r,n))return t.customType=i,e(t)},originalEvent:e[i]})});var t={animation:"animationend",transition:"transitionend"};Object.keys(t).forEach(function(e){var n=t[e];ee(n,{event:!0,delegate:!0,handler:function(e,t){return t.customType=n,e(t)},originalEvent:le.checkAnimationEventName()[e]})})}();var pe=pe||{};"undefined"!=typeof window&&(pe.window=window),"undefined"!=typeof document&&(pe.document=document);var ye=void 0,me=1,ge="core_"+(1e9*Math.random()>>>0);function _e(){ye=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}}function ke(e,t){return e||t}function Ee(e,t){if(e){var n=e[ge];return t&&!e.hasOwnProperty(ge)&&(n=null),n||(e[ge]=me++)}return me++}function Se(e){return void 0!==e}function be(e){return Se(e)&&!Ae(e)}function Pe(e){return e&&"object"===(void 0===e?"undefined":n(e))&&1===e.nodeType}function we(e){return"function"==typeof e}function Ae(e){return null===e}function Le(e){return"string"==typeof e||e instanceof String}function Te(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{checkEnv:!0},t="undefined"!=typeof process&&!process.browser;return t&&e.checkEnv&&(t=void 0!==process.env&&"test"!==process.env.NODE_ENV),t}var Ce=Object.freeze({UID_PROPERTY:ge,abstractMethod:function(){throw Error("Unimplemented abstract method")},disableCompatibilityMode:function(){ye=void 0},enableCompatibilityMode:_e,getCompatibilityModeData:function(){return void 0===ye&&"undefined"!=typeof window&&window.__METAL_COMPATIBILITY__&&_e(window.__METAL_COMPATIBILITY__),ye},getFunctionName:function(e){if(!e.name){var t=e.toString();e.name=t.substring(9,t.indexOf("("))}return e.name},getStaticProperty:function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ke,i=n+"_MERGED";if(!t.hasOwnProperty(i)){var a=t.hasOwnProperty(n)?t[n]:null;t.__proto__&&!t.__proto__.isPrototypeOf(Function)&&(a=r(a,e(t.__proto__,n,r))),t[i]=a}return t[i]},getUid:Ee,identityFunction:function(e){return e},isBoolean:function(e){return"boolean"==typeof e},isDef:Se,isDefAndNotNull:be,isDocument:function(e){return e&&"object"===(void 0===e?"undefined":n(e))&&9===e.nodeType},isDocumentFragment:function(e){return e&&"object"===(void 0===e?"undefined":n(e))&&11===e.nodeType},isElement:Pe,isFunction:we,isNull:Ae,isNumber:function(e){return"number"==typeof e},isWindow:function(e){return null!==e&&e===e.window},isObject:function(e){var t=void 0===e?"undefined":n(e);return"object"===t&&null!==e||"function"===t},isPromise:function(e){return e&&"object"===(void 0===e?"undefined":n(e))&&"function"==typeof e.then},isString:Le,isServerSide:Te,nullFunction:function(){}}),Oe=(t(Re,null,[{key:"equal",value:function(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}},{key:"firstDefinedValue",value:function(e){for(var t=0;t<e.length;t++)if(void 0!==e[t])return e[t]}},{key:"flatten",value:function(e,t){for(var n=1<arguments.length&&void 0!==t?t:[],r=0;r<e.length;r++)Array.isArray(e[r])?Re.flatten(e[r],n):n.push(e[r]);return n}},{key:"remove",value:function(e,t){var n,r=e.indexOf(t);return(n=0<=r)&&Re.removeAt(e,r),n}},{key:"removeAt",value:function(e,t){return 1===Array.prototype.splice.call(e,t,1).length}},{key:"slice",value:function(e,t,n){for(var r=2<arguments.length&&void 0!==n?n:e.length,i=[],a=t;a<r;a++)i.push(e[a]);return i}}]),Re);function Re(){a(this,Re)}var Ne={throwException:function(e){Ne.nextTick(function(){throw e})},run:function(e,t){Ne.run.workQueueScheduled_||(Ne.nextTick(Ne.run.processWorkQueue),Ne.run.workQueueScheduled_=!0),Ne.run.workQueue_.push(new Ne.run.WorkItem_(e,t))}};Ne.run.workQueueScheduled_=!1,Ne.run.workQueue_=[],Ne.run.processWorkQueue=function(){for(;Ne.run.workQueue_.length;){var e=Ne.run.workQueue_;Ne.run.workQueue_=[];for(var t=0;t<e.length;t++){var n=e[t];try{n.fn.call(n.scope)}catch(e){Ne.throwException(e)}}}Ne.run.workQueueScheduled_=!1},Ne.run.WorkItem_=function(e,t){this.fn=e,this.scope=t},Ne.nextTick=function(e,t){var n=e;t&&(n=e.bind(t)),n=Ne.nextTick.wrapCallback_(n),Ne.nextTick.setImmediate_||("function"==typeof setImmediate&&Te({checkEnv:!1})?Ne.nextTick.setImmediate_=setImmediate:Ne.nextTick.setImmediate_=Ne.nextTick.getSetImmediateEmulator_()),Ne.nextTick.setImmediate_(n)},Ne.nextTick.setImmediate_=null,Ne.nextTick.getSetImmediateEmulator_=function(){var e=void 0;if("function"==typeof MessageChannel&&(e=MessageChannel),void 0===e&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&(e=function(){var e=document.createElement("iframe");e.style.display="none",e.src="",e.title="",document.documentElement.appendChild(e);var t=e.contentWindow,n=t.document;n.open(),n.write(""),n.close();var r="callImmediate"+Math.random(),i=t.location.protocol+"//"+t.location.host,a=function(e){e.origin!==i&&e.data!==r||this.port1.onmessage()}.bind(this);t.addEventListener("message",a,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(r,i)}}}),void 0===e)return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("script")?function(e){var t=document.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,t.parentNode.removeChild(t),t=null,e(),e=null},document.documentElement.appendChild(t)}:function(e){setTimeout(e,0)};var t=new e,n={},r=n;return t.port1.onmessage=function(){var e=(n=n.next).cb;n.cb=null,e()},function(e){r.next={cb:e},r=r.next,t.port2.postMessage(0)}},Ne.nextTick.wrapCallback_=function(e){return e};var He=(t(Ie,[{key:"dispose",value:function(){this.disposed_||(this.disposeInternal(),this.disposed_=!0)}},{key:"disposeInternal",value:function(){}},{key:"isDisposed",value:function(){return this.disposed_}}]),Ie);function Ie(){a(this,Ie),this.disposed_=!1}var xe=(t(De,null,[{key:"mixin",value:function(e){for(var t=void 0,n=void 0,r=arguments.length,i=Array(1<r?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];for(var o=0;o<i.length;o++)for(t in n=i[o])e[t]=n[t];return e}},{key:"getObjectByName",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:window;return e.split(".").reduce(function(e,t){return e[t]},n)}},{key:"map",value:function(e,t){for(var n={},r=Object.keys(e),i=0;i<r.length;i++)n[r[i]]=t(r[i],e[r[i]]);return n}},{key:"shallowEqual",value:function(e,t){if(e===t)return!0;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var i=0;i<n.length;i++)if(e[n[i]]!==t[n[i]])return!1;return!0}}]),De);function De(){a(this,De)}var Ue=(t(Fe,null,[{key:"caseInsensitiveCompare",value:function(e,t){var n=String(e).toLowerCase(),r=String(t).toLowerCase();return n<r?-1:n===r?0:1}},{key:"collapseBreakingSpaces",value:function(e){return e.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}},{key:"escapeRegex",value:function(e){return String(e).replace(/([-()[\]{}+?*.$^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")}},{key:"getRandomString",value:function(){var e=2147483648;return Math.floor(Math.random()*e).toString(36)+Math.abs(Math.floor(Math.random()*e)^Date.now()).toString(36)}},{key:"hashCode",value:function(e){for(var t=0,n=0,r=e.length;n<r;n++)t=31*t+e.charCodeAt(n),t%=4294967296;return t}},{key:"replaceInterval",value:function(e,t,n,r){return e.substring(0,t)+r+e.substring(n)}}]),Fe);function Fe(){a(this,Fe)}var Me=Object.create,je=(i(qe,He),t(qe,[{key:"add",value:function(e,t){return this.keys[e.toLowerCase()]=e,this.values[e.toLowerCase()]=this.values[e.toLowerCase()]||[],this.values[e.toLowerCase()].push(t),this}},{key:"clear",value:function(){return this.keys=Me(null),this.values=Me(null),this}},{key:"contains",value:function(e){return e.toLowerCase()in this.values}},{key:"disposeInternal",value:function(){this.values=null}},{key:"get",value:function(e){var t=this.values[e.toLowerCase()];if(t)return t[0]}},{key:"getAll",value:function(e){return this.values[e.toLowerCase()]}},{key:"isEmpty",value:function(){return 0===this.size()}},{key:"names",value:function(){var t=this;return Object.keys(this.values).map(function(e){return t.keys[e]})}},{key:"remove",value:function(e){return delete this.keys[e.toLowerCase()],delete this.values[e.toLowerCase()],this}},{key:"set",value:function(e,t){return this.keys[e.toLowerCase()]=e,this.values[e.toLowerCase()]=[t],this}},{key:"size",value:function(){return this.names().length}},{key:"toString",value:function(){return JSON.stringify(this.values)}}],[{key:"fromObject",value:function(e){for(var t=new qe,n=Object.keys(e),r=0;r<n.length;r++)t.set(n[r],e[n[r]]);return t}}]),qe);function qe(){a(this,qe);var e=s(this,(qe.__proto__||Object.getPrototypeOf(qe)).call(this));return e.keys=Me(null),e.values=Me(null),e}function Be(e){a(this,Be),this.value_=e,this.parent_=null,this.children_=null}(t(Be,[{key:"addChild",value:function(e){Qe(e),e.setParent(this),this.children_=this.children_||[],this.children_.push(e)}},{key:"contains",value:function(e){for(var t=e.getParent();t;){if(t===this)return!0;t=t.getParent()}return!1}},{key:"getAncestors",value:function(){for(var e=[],t=this.getParent();t;)e.push(t),t=t.getParent();return e}},{key:"getChildAt",value:function(e){return this.getChildren()[e]||null}},{key:"getChildren",value:function(){return this.children_||Be.EMPTY_ARRAY}},{key:"getChildCount",value:function(){return this.getChildren().length}},{key:"getDepth",value:function(){for(var e=0,t=this;t.getParent();)e++,t=t.getParent();return e}},{key:"getParent",value:function(){return this.parent_}},{key:"getRoot",value:function(){for(var e=this;e.getParent();)e=e.getParent();return e}},{key:"getValue",value:function(){return this.value_}},{key:"isLeaf",value:function(){return!this.getChildCount()}},{key:"removeChild",value:function(e){return Oe.remove(this.getChildren(),e)?e:null}},{key:"setParent",value:function(e){this.parent_=e}},{key:"traverse",value:function(t,n){t&&t(this),this.getChildren().forEach(function(e){return e.traverse(t,n)}),n&&n(this)}}]),Be).EMPTY_ARRAY=[];var Qe=function(e){if(e.getParent())throw new Error("Cannot add child with parent.")},Ve=function(e){if(we(URL)&&URL.length){var t=new URL(e);if(t.port&&-1===t.href.indexOf(t.port))throw new TypeError(e+" is not a valid URL");return t}return function(e){var t=document.createElement("a");if(t.href=e,":"===t.protocol||!/:/.test(t.href))throw new TypeError(e+" is not a valid URL");return{hash:t.hash,hostname:t.hostname,password:t.password,pathname:"/"===t.pathname[0]?t.pathname:"/"+t.pathname,port:t.port,protocol:t.protocol,search:t.search,username:t.username}}(e)},We=(t(ze,[{key:"addParametersFromMultiMap",value:function(e){var n=this;return e.names().forEach(function(t){e.getAll(t).forEach(function(e){n.addParameterValue(t,e)})}),this}},{key:"addParameterValue",value:function(e,t){return this.ensureQueryInitialized_(),Se(t)&&(t=String(t)),this.query.add(e,t),this}},{key:"addParameterValues",value:function(t,e){var n=this;return e.forEach(function(e){return n.addParameterValue(t,e)}),this}},{key:"ensureQueryInitialized_",value:function(){var a=this;if(!this.query){this.query=new je;var e=this.url.search;e&&e.substring(1).split("&").forEach(function(e){var t=e.split("="),n=u(t,2),r=n[0],i=n[1];Se(i)&&(i=ze.urlDecode(i)),a.addParameterValue(r,i)})}}},{key:"getHash",value:function(){return this.url.hash||""}},{key:"getHost",value:function(){var e=this.getHostname();if(e){var t=this.getPort();t&&"80"!==t&&(e+=":"+t)}return e}},{key:"getHostname",value:function(){var e=this.url.hostname;return e===ze.HOSTNAME_PLACEHOLDER?"":e}},{key:"getOrigin",value:function(){var e=this.getHost();return e?this.getProtocol()+"//"+e:""}},{key:"getParameterValue",value:function(e){return this.ensureQueryInitialized_(),this.query.get(e)}},{key:"getParameterValues",value:function(e){return this.ensureQueryInitialized_(),this.query.getAll(e)}},{key:"getParameterNames",value:function(){return this.ensureQueryInitialized_(),this.query.names()}},{key:"getPathname",value:function(){return this.url.pathname}},{key:"getPort",value:function(){return this.url.port}},{key:"getProtocol",value:function(){return this.url.protocol}},{key:"getSearch",value:function(){var e=this,t="",n="";return this.getParameterNames().forEach(function(t){e.getParameterValues(t).forEach(function(e){n+=t,Se(e)&&(n+="="+encodeURIComponent(e)),n+="&"})}),(n=n.slice(0,-1))&&(t+="?"+n),t}},{key:"hasParameter",value:function(e){return this.ensureQueryInitialized_(),this.query.contains(e)}},{key:"makeUnique",value:function(){return this.setParameterValue(ze.RANDOM_PARAM,Ue.getRandomString()),this}},{key:"maybeAddProtocolAndHostname_",value:function(e){var t=e;if(-1===e.indexOf("://")&&0!==e.indexOf("javascript:"))switch(t=ze.DEFAULT_PROTOCOL,"/"===e[0]&&"/"===e[1]||(t+="//"),e.charAt(0)){case".":case"?":case"#":t+=ze.HOSTNAME_PLACEHOLDER,t+="/",t+=e;break;case"":case"/":"/"!==e[1]&&(t+=ze.HOSTNAME_PLACEHOLDER),t+=e;break;default:t+=e}return t}},{key:"removeParameter",value:function(e){return this.ensureQueryInitialized_(),this.query.remove(e),this}},{key:"removeUnique",value:function(){return this.removeParameter(ze.RANDOM_PARAM),this}},{key:"setHash",value:function(e){return this.url.hash=e,this}},{key:"setHostname",value:function(e){return this.url.hostname=e,this}},{key:"setParameterValue",value:function(e,t){return this.removeParameter(e),this.addParameterValue(e,t),this}},{key:"setParameterValues",value:function(t,e){var n=this;return this.removeParameter(t),e.forEach(function(e){return n.addParameterValue(t,e)}),this}},{key:"setPathname",value:function(e){return this.url.pathname=e,this}},{key:"setPort",value:function(e){return this.url.port=e,this}},{key:"setProtocol",value:function(e){return this.url.protocol=e,":"!==this.url.protocol[this.url.protocol.length-1]&&(this.url.protocol+=":"),this}},{key:"toString",value:function(){var e="",t=this.getHost();return t&&(e+=this.getProtocol()+"//"),e+=t+this.getPathname()+this.getSearch()+this.getHash()}}],[{key:"getParseFn",value:function(){return Ve}},{key:"parse",value:function(e){return Ve(e)}},{key:"setParseFn",value:function(e){Ve=e}},{key:"joinPaths",value:function(e){for(var t=arguments.length,n=Array(1<t?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return"/"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1)),n=n.map(function(e){return"/"===e.charAt(0)?e.substring(1):e}),[e].concat(n).join("/").replace(/\/$/,"")}},{key:"urlDecode",value:function(e){return decodeURIComponent(e.replace(/\+/g," "))}}]),ze);function ze(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"";a(this,ze),this.url=ze.parse(this.maybeAddProtocolAndHostname_(e))}We.DEFAULT_PROTOCOL="undefined"!=typeof window&&window.location&&window.location.protocol&&0===window.location.protocol.indexOf("https")?"https:":"http:",We.HOSTNAME_PLACEHOLDER="hostname"+Date.now(),We.RANDOM_PARAM="zx";var Xe=(t($e,null,[{key:"copyNodeAttributes",value:function(e,t){Array.prototype.slice.call(e.attributes).forEach(function(e){return t.setAttribute(e.name,e.value)})}},{key:"debounce",value:function(n,r){return function e(){var t=arguments;$e.cancelDebounce(e),e.id=setTimeout(function(){n(Array.prototype.slice.call(t))},r)}}},{key:"cancelDebounce",value:function(e){clearTimeout(e.id)}},{key:"getCurrentBrowserPath",value:function(){return this.getCurrentBrowserPathWithoutHash()+pe.window.location.hash}},{key:"getCurrentBrowserPathWithoutHash",value:function(){return pe.window.location.pathname+pe.window.location.search}},{key:"getNodeOffset",value:function(e){for(var t=0,n=0;t+=e.offsetLeft,n+=e.offsetTop,e=e.offsetParent;);return{offsetLeft:t,offsetTop:n}}},{key:"getUrlPath",value:function(e){var t=new We(e);return t.getPathname()+t.getSearch()+t.getHash()}},{key:"getUrlPathWithoutHash",value:function(e){var t=new We(e);return t.getPathname()+t.getSearch()}},{key:"getUrlPathWithoutHashAndSearch",value:function(e){return new We(e).getPathname()}},{key:"isCurrentBrowserPath",value:function(e){if(e){var t=this.getCurrentBrowserPathWithoutHash();return $e.getUrlPathWithoutHash(e)===this.getUrlPath(t)}return!1}},{key:"isChrome",value:function(){return($e.matchUserAgent("Chrome")||$e.matchUserAgent("CriOs"))&&!$e.isOpera()&&!$e.isEdge()}},{key:"isEdge",value:function(){return $e.matchUserAgent("Edge")}},{key:"isIe",value:function(){return $e.matchUserAgent("Trident")||$e.matchUserAgent("MSIE")}},{key:"isIeOrEdge",value:function(){return $e.isIe()||$e.isEdge()}},{key:"isOpera",value:function(){return $e.matchUserAgent("Opera")||$e.matchUserAgent("OPR")}},{key:"isSafari",value:function(){return $e.matchUserAgent("Safari")&&!($e.isChrome()||$e.isOpera()||$e.isEdge())}},{key:"matchUserAgent",value:function(e){var t=pe.window.navigator;return!(!t||!t.userAgent)&&-1!==t.userAgent.indexOf(e)}},{key:"isHtml5HistorySupported",value:function(){return!(!pe.window.history||!pe.window.history.pushState)}},{key:"isWebUri",value:function(t){try{return new We(t)}catch(e){return console.error(e.message+" "+t),!1}}},{key:"clearNodeAttributes",value:function(t){Array.prototype.slice.call(t.attributes).forEach(function(e){return t.removeAttribute(e.name)})}},{key:"removeElementsFromDocument",value:function(e){e.forEach(function(e){return Y(e)})}},{key:"removePathTrailingSlash",value:function(e){var t=e?e.length:0;return 1<t&&"/"===e[t-1]&&(e=e.substr(0,t-1)),e}},{key:"setElementWithRandomHref",value:function(e){return e.href=e.href+"?q="+Math.random(),e}},{key:"setReferrer",value:function(e){Object.defineProperty(pe.document,"referrer",{configurable:!0,get:function(){return e}})}}]),$e);function $e(){a(this,$e)}var Ye="data-senna-base-path",Ge="data-senna-link-selector",Ke="data-senna-loading-css-class",Je="data-senna",Ze="data-senna-dispatch",et="data-senna-surface",tt="data-senna-update-scroll-position",nt=(i(rt,He),t(rt,[{key:"disposeInternal",value:function(){this.removeListener(),this.emitter_=null,this.listener_=null}},{key:"removeListener",value:function(){this.emitter_.isDisposed()||this.emitter_.removeListener(this.event_,this.listener_)}}]),rt);function rt(e,t,n){a(this,rt);var r=s(this,(rt.__proto__||Object.getPrototypeOf(rt)).call(this));return r.emitter_=e,r.event_=t,r.listener_=n,r}var it=[0],at=(i(ot,He),t(ot,[{key:"addHandler_",value:function(e,t){return e?(Array.isArray(e)||(e=[e]),e.push(t)):e=t,e}},{key:"addListener",value:function(e,t,n){this.validateListener_(t);for(var r=this.toEventsArray_(e),i=0;i<r.length;i++)this.addSingleListener_(r[i],t,n);return new nt(this,e,t)}},{key:"addSingleListener_",value:function(e,t,n,r){this.runListenerHandlers_(e),(n||r)&&(t={default:n,fn:t,origin:r}),this.events_=this.events_||{},this.events_[e]=this.addHandler_(this.events_[e],t)}},{key:"buildFacade_",value:function(e){if(this.getShouldUseFacade()){var t={preventDefault:function(){t.preventedDefault=!0},target:this,type:e};return t}}},{key:"disposeInternal",value:function(){this.events_=null}},{key:"emit",value:function(e){var t=this.getRawListeners_(e);if(0===t.length)return!1;var n=Oe.slice(arguments,1);return this.runListeners_(t,n,this.buildFacade_(e)),!0}},{key:"getRawListeners_",value:function(e){return st(this.events_&&this.events_[e]).concat(st(this.events_&&this.events_["*"]))}},{key:"getShouldUseFacade",value:function(){return this.shouldUseFacade_}},{key:"listeners",value:function(e){return this.getRawListeners_(e).map(function(e){return e.fn?e.fn:e})}},{key:"many",value:function(e,t,n){for(var r=this.toEventsArray_(e),i=0;i<r.length;i++)this.many_(r[i],t,n);return new nt(this,e,n)}},{key:"many_",value:function(t,n,r){var i=this;n<=0||i.addSingleListener_(t,function e(){0==--n&&i.removeListener(t,e),r.apply(i,arguments)},!1,r)}},{key:"matchesListener_",value:function(e,t){return(e.fn||e)===t||e.origin&&e.origin===t}},{key:"off",value:function(e,t){if(this.validateListener_(t),!this.events_)return this;for(var n=this.toEventsArray_(e),r=0;r<n.length;r++)this.events_[n[r]]=this.removeMatchingListenerObjs_(st(this.events_[n[r]]),t);return this}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"onListener",value:function(e){this.listenerHandlers_=this.addHandler_(this.listenerHandlers_,e)}},{key:"once",value:function(e,t){return this.many(e,1,t)}},{key:"removeAllListeners",value:function(e){if(this.events_)if(e)for(var t=this.toEventsArray_(e),n=0;n<t.length;n++)this.events_[t[n]]=null;else this.events_=null;return this}},{key:"removeMatchingListenerObjs_",value:function(e,t){for(var n=[],r=0;r<e.length;r++)this.matchesListener_(e[r],t)||n.push(e[r]);return 0<n.length?n:null}},{key:"removeListener",value:function(){return this.off.apply(this,arguments)}},{key:"runListenerHandlers_",value:function(e){var t=this.listenerHandlers_;if(t){t=st(t);for(var n=0;n<t.length;n++)t[n](e)}}},{key:"runListeners_",value:function(e,t,n){n&&t.push(n);for(var r=[],i=0;i<e.length;i++){var a=e[i].fn||e[i];e[i].default?r.push(a):a.apply(this,t)}if(!n||!n.preventedDefault)for(var o=0;o<r.length;o++)r[o].apply(this,t)}},{key:"setShouldUseFacade",value:function(e){return this.shouldUseFacade_=e,this}},{key:"toEventsArray_",value:function(e){return Le(e)&&(it[0]=e,e=it),e}},{key:"validateListener_",value:function(e){if(!we(e))throw new TypeError("Listener must be a function")}}]),ot);function ot(){a(this,ot);var e=s(this,(ot.__proto__||Object.getPrototypeOf(ot)).call(this));return e.events_=null,e.listenerHandlers_=null,e.shouldUseFacade_=!1,e}function st(e){return e=e||[],Array.isArray(e)?e:[e]}i(ut,He),t(ut,[{key:"addListener_",value:function(e,t){return this.originEmitter_.on(e,t)}},{key:"disposeInternal",value:function(){this.removeListeners_(),this.proxiedEvents_=null,this.originEmitter_=null,this.targetEmitter_=null}},{key:"emitOnTarget_",value:function(){var e;(e=this.targetEmitter_).emit.apply(e,arguments)}},{key:"proxyEvent",value:function(e){this.shouldProxyEvent_(e)&&this.tryToAddListener_(e)}},{key:"removeListeners_",value:function(){if(this.proxiedEvents_){for(var e=Object.keys(this.proxiedEvents_),t=0;t<e.length;t++)this.proxiedEvents_[e[t]].removeListener();this.proxiedEvents_=null}this.pendingEvents_=null}},{key:"setOriginEmitter",value:function(e){var t=this,n=this.originEmitter_&&this.proxiedEvents_?Object.keys(this.proxiedEvents_):this.pendingEvents_;this.originEmitter_=e,n&&(this.removeListeners_(),n.forEach(function(e){return t.proxyEvent(e)}))}},{key:"shouldProxyEvent_",value:function(e){return!(this.whitelist_&&!this.whitelist_[e]||this.blacklist_&&this.blacklist_[e]||this.proxiedEvents_&&this.proxiedEvents_[e])}},{key:"startProxy_",value:function(){this.targetEmitter_.onListener(this.proxyEvent.bind(this))}},{key:"tryToAddListener_",value:function(e){this.originEmitter_?(this.proxiedEvents_=this.proxiedEvents_||{},this.proxiedEvents_[e]=this.addListener_(e,this.emitOnTarget_.bind(this,e))):(this.pendingEvents_=this.pendingEvents_||[],this.pendingEvents_.push(e))}}]);function ut(e,t,n,r){a(this,ut);var i=s(this,(ut.__proto__||Object.getPrototypeOf(ut)).call(this));return i.blacklist_=n,i.originEmitter_=e,i.pendingEvents_=null,i.proxiedEvents_=null,i.targetEmitter_=t,i.whitelist_=r,i.startProxy_(),i}var lt=(i(ct,He),t(ct,[{key:"add",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0;r<arguments.length;r++)this.eventHandles_.push(t[r])}},{key:"disposeInternal",value:function(){this.eventHandles_=null}},{key:"removeAllListeners",value:function(){for(var e=0;e<this.eventHandles_.length;e++)this.eventHandles_[e].removeListener();this.eventHandles_=[]}}]),ct);function ct(){a(this,ct);var e=s(this,(ct.__proto__||Object.getPrototypeOf(ct)).call(this));return e.eventHandles_=[],e}var ht=/([\/])?(?:(?:\:(\w+)(?:\(((?:\\.|[^\\()])*)\))?|\(((?:\\.|[^\\()])+)\))([+*?])?)/g;function ft(e){for(var t="",n=0;n<e.length;n++)if(Ce.isString(e[n]))t+=dt(e[n]);else{var r=vt(e[n].pattern);e[n].repeat&&(r+=vt("\\/"+r)+"*"),r=dt(e[n].prefix)+"("+r+")",e[n].optional&&(e[n].partial||(r=vt(r)),r+="?"),t+=r}return new RegExp("^"+function(e){/\/$/.test(e)?e+="?":e+="\\/?";return e}(t)+"$")}function vt(e){return"(?:"+e+")"}function dt(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function pt(e){if(!Ce.isString(e))return e;for(var t,n=e,r=0,i=[],a="",o=0,s=ht.exec(n);s;){var u={match:(t=s)[0],prefix:t[1],name:t[2],paramPattern:t[3],unnamedPattern:t[4],modifier:t[5]};a=n.slice(o,s.index),o=s.index+u.match.length,i.push(a),i.push({name:u.name?u.name:""+r++,partial:n[o]&&n[o]!==u.prefix,prefix:u.prefix||"",pattern:u.paramPattern||u.unnamedPattern||"[^\\/]+",repeat:"*"===u.modifier||"+"===u.modifier,optional:"*"===u.modifier||"?"===u.modifier}),s=ht.exec(n)}return o<n.length&&i.push(n.substr(o)),i}var yt=(t(mt,[{key:"buildParsedData_",value:function(){if(!this.parsedData_){var e=pt(this.path),t=function(e){return ft(pt(e))}(e);this.parsedData_={regex:t,tokens:e}}return this.parsedData_}},{key:"extractParams",value:function(e){return Le(this.path)?function(e,t){var n={},r=pt(e),i=t.match(ft(r));if(!i)return null;for(var a=1,o=0;o<r.length;o++)if(!Ce.isString(r[o])){var s=i[a++];Ce.isDef(s)&&(r[o].repeat&&(s=s.split("/")),n[r[o].name]=s)}return n}(this.buildParsedData_().tokens,e):{}}},{key:"getHandler",value:function(){return this.handler}},{key:"getPath",value:function(){return this.path}},{key:"matchesPath",value:function(e){var t=this.path;return we(t)?t(e):(Le(t)&&(t=this.buildParsedData_().regex),t instanceof RegExp&&-1<e.search(t))}}]),mt);function mt(e,t){if(a(this,mt),!be(e))throw new Error("Route path not specified.");if(!we(t))throw new Error("Route handler is not a function.");this.handler=t,this.path=e}var gt=(i(_t,He),t(_t,[{key:"addCache",value:function(e){return this.cacheable&&(this.cache=e),this}},{key:"clearCache",value:function(){return this.cache=null,this}},{key:"disposeInternal",value:function(){this.clearCache()}},{key:"getCache",value:function(){return this.cache}},{key:"isCacheable",value:function(){return this.cacheable}},{key:"setCacheable",value:function(e){e||this.clearCache(),this.cacheable=e}}]),_t);function _t(){a(this,_t);var e=s(this,(_t.__proto__||Object.getPrototypeOf(_t)).call(this));return e.cache=null,e.cacheable=!1,e}var kt=(i(Et,gt),t(Et,[{key:"activate",value:function(){console.log("Screen ["+this+"] activate")}},{key:"beforeActivate",value:function(){console.log("Screen ["+this+"] beforeActivate")}},{key:"beforeDeactivate",value:function(){console.log("Screen ["+this+"] beforeDeactivate")}},{key:"beforeUpdateHistoryPath",value:function(e){return e}},{key:"beforeUpdateHistoryState",value:function(e){return e}},{key:"deactivate",value:function(){console.log("Screen ["+this+"] deactivate")}},{key:"disposeInternal",value:function(){o(Et.prototype.__proto__||Object.getPrototypeOf(Et.prototype),"disposeInternal",this).call(this),console.log("Screen ["+this+"] dispose")}},{key:"evaluateScripts",value:function(t){return Object.keys(t).forEach(function(e){t[e].activeChild&&he.runScriptsInElement(t[e].activeChild)}),Promise.resolve()}},{key:"evaluateStyles",value:function(){return Promise.resolve()}},{key:"flip",value:function(n){var r=this;console.log("Screen ["+this+"] flip");var i=[];return Object.keys(n).forEach(function(e){var t=n[e].show(r.id);i.push(t)}),Promise.all(i)}},{key:"getId",value:function(){return this.id}},{key:"getMetas",value:function(){return this.metas}},{key:"getSurfaceContent",value:function(){console.log("Screen ["+this+"] getSurfaceContent")}},{key:"getTitle",value:function(){return this.title}},{key:"load",value:function(){return console.log("Screen ["+this+"] load"),Promise.resolve()}},{key:"makeId_",value:function(e){return"screen_"+e}},{key:"setId",value:function(e){this.id=e}},{key:"setMetas",value:function(e){this.metas=e}},{key:"setTitle",value:function(e){this.title=e}},{key:"toString",value:function(){return this.id}}]),Et);function Et(){a(this,Et);var e=s(this,(Et.__proto__||Object.getPrototypeOf(Et)).call(this));return e.id=e.makeId_(Ee()),e.metas=null,e.title=null,e}kt.isImplementedBy=function(e){return e instanceof kt};var St=(i(bt,He),t(bt,[{key:"addContent",value:function(e,t){var n=this.defaultChild;be(t)&&((n=this.getChild(e))?function(e){for(var t=void 0;t=e.firstChild;)e.removeChild(t)}(n):(n=this.createChild(e),this.transition(n,null)),V(n,t));var r=this.getElement();return r&&n&&V(r,n),n}},{key:"createChild",value:function(e){var t=pe.document.createElement("div");return t.setAttribute("id",this.makeId_(e)),t}},{key:"getChild",value:function(e){return pe.document.getElementById(this.makeId_(e))}},{key:"getElement",value:function(){return this.element||(this.element=pe.document.getElementById(this.id)),this.element}},{key:"getId",value:function(){return this.id}},{key:"getTransitionFn",value:function(){return this.transitionFn}},{key:"makeId_",value:function(e){return this.id+"-"+e}},{key:"maybeWrapContentAsDefault_",value:function(){var e=this.getElement();if(e&&!this.defaultChild){for(var t=pe.document.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);this.defaultChild=this.addContent(bt.DEFAULT,t),this.transition(null,this.defaultChild)}}},{key:"setId",value:function(e){this.id=e}},{key:"setTransitionFn",value:function(e){this.transitionFn=e}},{key:"show",value:function(e){var t=this.activeChild,n=this.getChild(e);function r(){t&&t!==n&&Y(t)}return n=n||this.defaultChild,this.activeChild=n,this.transition(t,n).then(r).catch(r)}},{key:"remove",value:function(e){var t=this.getChild(e);t&&Y(t)}},{key:"toString",value:function(){return this.id}},{key:"transition",value:function(e,t){var n=this.transitionFn||bt.defaultTransition;return Promise.resolve(n.call(this,e,t))}}]),bt);function bt(e){a(this,bt);var t=s(this,(bt.__proto__||Object.getPrototypeOf(bt)).call(this));if(!e)throw new Error("Surface element id not specified. A surface element requires a valid id.");return t.activeChild=null,t.defaultChild=null,t.element=null,t.id=e,t.transitionFn=null,t.defaultChild=t.getChild(bt.DEFAULT),t.maybeWrapContentAsDefault_(),t.activeChild=t.defaultChild,t}St.DEFAULT="default",St.defaultTransition=function(e,t){e&&(e.style.display="none",e.classList.remove("flipped")),t&&(t.style.display="block",t.classList.add("flipped"))};var Pt="immediate",wt="scheduleLast",At=(i(Lt,at),t(Lt,[{key:"addRoutes",value:function(e){var t=this;return Array.isArray(e)||(e=[e]),e.forEach(function(e){e instanceof yt||(e=new yt(e.path,e.handler)),t.routes.push(e)}),this}},{key:"addSurfaces",value:function(e){var t=this;return Array.isArray(e)||(e=[e]),e.forEach(function(e){Le(e)&&(e=new St(e)),t.surfaces[e.getId()]=e}),this}},{key:"canNavigate",value:function(e){var t=Xe.isWebUri(e);if(!t)return!1;var n=Xe.getUrlPath(e);return this.isLinkSameOrigin_(t.getHost())?this.isSameBasePath_(n)?!(t.getHash()&&Xe.isCurrentBrowserPath(n)||!this.findRoute(n)&&(console.log("No route for "+n),1)):(console.log("Link clicked outside app's base path"),!1):(console.log("Offsite link clicked"),!1)}},{key:"clearScreensCache",value:function(){var t=this;Object.keys(this.screens).forEach(function(e){e===t.activePath?t.activeScreen.clearCache():t.isNavigationPending&&t.pendingNavigate.path===e||t.removeScreen(e)})}},{key:"createScreenInstance",value:function(e,t){if(!this.pendingNavigate&&e===this.activePath)return console.log("Already at destination, refresh navigation"),this.activeScreen;var n=this.screens[e];if(!n){var r=t.getHandler();n=r===kt||kt.isImplementedBy(r.prototype)?new r:r(t)||new kt,console.log("Create screen for ["+e+"] ["+n+"]")}return n}},{key:"disposeInternal",value:function(){this.activeScreen&&this.removeScreen(this.activePath),this.clearScreensCache(),this.formEventHandler_.removeListener(),this.linkEventHandler_.removeListener(),this.appEventHandlers_.removeAllListeners(),o(Lt.prototype.__proto__||Object.getPrototypeOf(Lt.prototype),"disposeInternal",this).call(this)}},{key:"dispatch",value:function(){return this.navigate(Xe.getCurrentBrowserPath(),!0)}},{key:"doNavigate_",value:function(t,e){var n=this,r=this.findRoute(t);if(!r)return this.pendingNavigate=Promise.reject(new Error("No route for "+t)),this.pendingNavigate;function i(){if(n.navigationStrategy=Pt,n.scheduledNavigationQueue.length){var e=n.scheduledNavigationQueue.shift();n.maybeNavigate_(e.href,e)}}console.log("Navigate to ["+t+"]"),this.stopPendingNavigate_(),this.isNavigationPending=!0;var a=this.createScreenInstance(t,r);return this.maybePreventDeactivate_().then(function(){return n.maybePreventActivate_(a)}).then(function(){return a.load(t)}).then(function(){n.navigationStrategy=wt,n.activeScreen&&n.activeScreen.deactivate(),n.prepareNavigateHistory_(t,a,e),n.prepareNavigateSurfaces_(a,n.surfaces,n.extractParams(r,t))}).then(function(){return a.evaluateStyles(n.surfaces)}).then(function(){return a.flip(n.surfaces)}).then(function(){return a.evaluateScripts(n.surfaces)}).then(function(){return n.maybeUpdateScrollPositionState_()}).then(function(){return n.syncScrollPositionSyncThenAsync_()}).then(function(){return n.finalizeNavigate_(t,a)}).then(function(){return n.maybeOverloadBeforeUnload_()}).then(function(){i()}).catch(function(e){throw n.isNavigationPending=!1,n.handleNavigateError_(t,a,e),i(),e})}},{key:"extractParams",value:function(e,t){return e.extractParams(this.getRoutePath(t))}},{key:"finalizeNavigate_",value:function(e,t){t.activate(),this.activeScreen&&!this.activeScreen.isCacheable()&&this.activeScreen!==t&&this.removeScreen(this.activePath),this.activePath=e,this.activeScreen=t,this.browserPathBeforeNavigate=Xe.getCurrentBrowserPathWithoutHash(),this.screens[e]=t,this.isNavigationPending=!1,this.pendingNavigate=null,pe.capturedFormElement=null,pe.capturedFormButtonElement=null,console.log("Navigation done")}},{key:"findRoute",value:function(e){e=this.getRoutePath(e);for(var t=0;t<this.routes.length;t++){var n=this.routes[t];if(n.matchesPath(e))return n}return null}},{key:"getAllowPreventNavigate",value:function(){return this.allowPreventNavigate}},{key:"getBasePath",value:function(){return this.basePath}},{key:"getDefaultTitle",value:function(){return this.defaultTitle}},{key:"getFormSelector",value:function(){return this.formSelector}},{key:"getIgnoreQueryStringFromRoutePath",value:function(){return this.ignoreQueryStringFromRoutePath}},{key:"getLinkSelector",value:function(){return this.linkSelector}},{key:"getLoadingCssClass",value:function(){return this.loadingCssClass}},{key:"getRoutePath",value:function(e){return this.getIgnoreQueryStringFromRoutePath()?(e=Xe.getUrlPathWithoutHashAndSearch(e),Xe.getUrlPathWithoutHashAndSearch(e.substr(this.basePath.length))):(e=Xe.getUrlPathWithoutHash(e),Xe.getUrlPathWithoutHash(e.substr(this.basePath.length)))}},{key:"getUpdateScrollPosition",value:function(){return this.updateScrollPosition}},{key:"handleNavigateError_",value:function(t,e,n){var r=this;console.log("Navigation error for ["+e+"] ("+n.stack+")"),this.emit("navigationError",{error:n,nextScreen:e,path:t}),Xe.isCurrentBrowserPath(t)||(this.isNavigationPending&&this.pendingNavigate?this.pendingNavigate.then(function(){return r.removeScreen(t)}).catch(function(e){throw r.removeScreen(t),e}):this.removeScreen(t))}},{key:"hasRoutes",value:function(){return 0<this.routes.length}},{key:"isLinkSameOrigin_",value:function(e){var t=new We(e),n=new We(pe.window.location.host);return t.getPort()===n.getPort()&&t.getHostname()===n.getHostname()}},{key:"isSameBasePath_",value:function(e){return 0===e.indexOf(this.basePath)}},{key:"lockHistoryScrollPosition_",value:function(){var t=pe.window.history.state;if(t){var n=!1,e=function e(){pe.document.removeEventListener("scroll",e,!1),n||(pe.window.scrollTo(t.scrollLeft,t.scrollTop),n=!0)};Ne.nextTick(e),pe.document.addEventListener("scroll",e,!1)}}},{key:"maybeDisableNativeScrollRestoration",value:function(){this.nativeScrollRestorationSupported&&(this.nativeScrollRestoration_=pe.window.history.scrollRestoration,pe.window.history.scrollRestoration="manual")}},{key:"maybeScheduleNavigation_",value:function(e,t){return!(!this.isNavigationPending||this.navigationStrategy!==wt||(this.scheduledNavigationQueue=[xe.mixin({href:e,isScheduledNavigation:!0},t)],0))}},{key:"maybeNavigate_",value:function(e,t){if(this.canNavigate(e))if(this.maybeScheduleNavigation_(e,t))t.preventDefault();else{var n=!1;try{this.navigate(Xe.getUrlPath(e),!1,t)}catch(e){n=!0}n||t.isScheduledNavigation||t.preventDefault()}}},{key:"maybeOverloadBeforeUnload_",value:function(){var t=this;"function"==typeof window.onbeforeunload&&(window._onbeforeunload=window.onbeforeunload,window.onbeforeunload=function(e){if(t.emit("beforeUnload",e),e&&e.defaultPrevented)return!0},window.onbeforeunload._overloaded=!0)}},{key:"maybePreventActivate_",value:function(e){var t=this;return Promise.resolve().then(function(){return e.beforeActivate()}).then(function(e){if(e)return t.pendingNavigate=Promise.reject("Cancelled by next screen"),t.pendingNavigate})}},{key:"maybePreventDeactivate_",value:function(){var t=this;return Promise.resolve().then(function(){if(t.activeScreen)return t.activeScreen.beforeDeactivate()}).then(function(e){if(e)return t.pendingNavigate=Promise.reject(new Error("Cancelled by active screen")),t.pendingNavigate})}},{key:"maybeRepositionScrollToHashedAnchor",value:function(){var e=pe.window.location.hash;if(e){var t=pe.document.getElementById(e.substring(1));if(t){var n=Xe.getNodeOffset(t),r=n.offsetLeft,i=n.offsetTop;pe.window.scrollTo(r,i)}}}},{key:"maybeRestoreNativeScrollRestoration",value:function(){this.nativeScrollRestorationSupported&&this.nativeScrollRestoration_&&(pe.window.history.scrollRestoration=this.nativeScrollRestoration_)}},{key:"maybeRestoreRedirectPathHash_",value:function(e,t,n){return t===Xe.getUrlPathWithoutHash(e)?t+n:t}},{key:"maybeUpdateScrollPositionState_",value:function(){var e=pe.window.location.hash,t=pe.document.getElementById(e.substring(1));if(t){var n=Xe.getNodeOffset(t),r=n.offsetLeft,i=n.offsetTop;this.saveHistoryCurrentPageScrollPosition_(i,r)}}},{key:"navigate",value:function(e,t,n){if(!Xe.isHtml5HistorySupported())throw new Error("HTML5 History is not supported. Senna will not intercept navigation.");return n&&(pe.capturedFormElement=n.capturedFormElement,pe.capturedFormButtonElement=n.capturedFormButtonElement),e===this.activePath&&(t=!0),this.emit("beforeNavigate",{event:n,path:e,replaceHistory:!!t}),this.pendingNavigate}},{key:"onBeforeNavigate_",value:function(e){pe.capturedFormElement&&(e.form=pe.capturedFormElement)}},{key:"onBeforeNavigateDefault_",value:function(e){!this.pendingNavigate||this.pendingNavigate.path!==e.path&&this.navigationStrategy!==wt?(this.emit("beforeUnload",e),this.emit("startNavigate",{form:e.form,path:e.path,replaceHistory:e.replaceHistory})):console.log("Waiting...")}},{key:"onBeforeUnloadDefault_",value:function(e){var t=window._onbeforeunload;t&&!t._overloaded&&t()&&e.preventDefault()}},{key:"onDocClickDelegate_",value:function(e){e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||e.button?console.log("Navigate aborted, invalid mouse button or modifier key pressed."):this.maybeNavigate_(e.delegateTarget.href,e)}},{key:"onDocSubmitDelegate_",value:function(e){var t=e.delegateTarget;if("get"!==t.method){e.capturedFormElement=t;var n="button:not([type]),button[type=submit],input[type=submit]";K(pe.document.activeElement,n)?e.capturedFormButtonElement=pe.document.activeElement:e.capturedFormButtonElement=t.querySelector(n),this.maybeNavigate_(t.action,e)}else console.log("GET method not supported")}},{key:"onLoad_",value:function(){var e=this;this.skipLoadPopstate=!0,setTimeout(function(){e.skipLoadPopstate=!1},0),this.maybeRepositionScrollToHashedAnchor()}},{key:"onPopstate_",value:function(e){if(!this.skipLoadPopstate)if(Xe.isCurrentBrowserPath(this.browserPathBeforeNavigate))this.maybeRepositionScrollToHashedAnchor();else{var t=e.state;if(t){if(t.senna){console.log("History navigation to ["+t.path+"]"),this.popstateScrollTop=t.scrollTop,this.popstateScrollLeft=t.scrollLeft,this.nativeScrollRestorationSupported||this.lockHistoryScrollPosition_(),this.once("endNavigate",function(){t.referrer&&Xe.setReferrer(t.referrer)});var n=new We(t.path);if(n.setHostname(pe.window.location.hostname),n.setPort(pe.window.location.port),this.maybeScheduleNavigation_(n.toString(),{}))return;this.navigate(t.path,!0)}}else pe.window.location.hash?(this.redirectPath&&!Xe.isCurrentBrowserPath(this.redirectPath)&&this.reloadPage(),this.maybeRepositionScrollToHashedAnchor()):this.reloadPage()}}},{key:"onScroll_",value:function(){this.captureScrollPositionFromScrollEvent&&this.saveHistoryCurrentPageScrollPosition_(pe.window.pageYOffset,pe.window.pageXOffset)}},{key:"onStartNavigate_",value:function(e){var t=this;function n(e){t.pendingNavigate||t.scheduledNavigationQueue.length||(function(e,t){if(c(e)&&h(t)){e.length||(e=[e]);for(var n=0;n<e.length;n++)"classList"in e[n]?te(e[n],t):ne(e[n],t)}}(pe.document.documentElement,t.loadingCssClass),t.maybeRestoreNativeScrollRestoration(),t.captureScrollPositionFromScrollEvent=!0),t.emit("endNavigate",e)}this.maybeDisableNativeScrollRestoration(),this.captureScrollPositionFromScrollEvent=!1,function(e,t){if(c(e)&&h(t)){e.length||(e=[e]);for(var n=0;n<e.length;n++)"classList"in e[n]?q(e[n],t):B(e[n],t)}}(pe.document.documentElement,this.loadingCssClass);var r={form:e.form,path:e.path};this.pendingNavigate=this.doNavigate_(e.path,e.replaceHistory).then(function(){n(r)}).catch(function(e){throw n(r),r.error=e}),this.pendingNavigate.path=e.path}},{key:"prefetch",value:function(t){var n=this,e=this.findRoute(t);if(!e)return Promise.reject(new Error("No route for "+t));console.log("Prefetching ["+t+"]");var r=this.createScreenInstance(t,e);return r.load(t).then(function(){return n.screens[t]=r}).catch(function(e){throw n.handleNavigateError_(t,r,e),e})}},{key:"prepareNavigateHistory_",value:function(e,t,n){var r=t.getTitle();Le(r)||(r=this.getDefaultTitle());var i=t.beforeUpdateHistoryPath(e),a={form:be(pe.capturedFormElement),path:e,redirectPath:i,scrollLeft:0,scrollTop:0,senna:!0};n&&(a.scrollTop=this.popstateScrollTop,a.scrollLeft=this.popstateScrollLeft);var o=new We(e).getHash();i=this.maybeRestoreRedirectPathHash_(e,i,o),this.updateHistory_(r,i,t.beforeUpdateHistoryState(a),n),this.redirectPath=i}},{key:"prepareNavigateSurfaces_",value:function(n,r,i){Object.keys(r).forEach(function(e){var t=n.getSurfaceContent(e,i);r[e].addContent(n.getId(),t),console.log("Screen ["+n.getId()+"] add content to surface ["+r[e]+"] ["+(be(t)?"...":"empty")+"]")})}},{key:"reloadPage",value:function(){pe.window.location.reload()}},{key:"removeRoute",value:function(e){return Oe.remove(this.routes,e)}},{key:"removeScreen",value:function(e){var t=this,n=this.screens[e];n&&(Object.keys(this.surfaces).forEach(function(e){return t.surfaces[e].remove(n.getId())}),n.dispose(),delete this.screens[e])}},{key:"saveHistoryCurrentPageScrollPosition_",value:function(e,t){var n=pe.window.history.state;if(n&&n.senna){var r=[e,t];n.scrollTop=r[0],n.scrollLeft=r[1],pe.window.history.replaceState(n,null,null)}}},{key:"setAllowPreventNavigate",value:function(e){this.allowPreventNavigate=e}},{key:"setBasePath",value:function(e){this.basePath=Xe.removePathTrailingSlash(e)}},{key:"setDefaultTitle",value:function(e){this.defaultTitle=e}},{key:"setFormSelector",value:function(e){this.formSelector=e,this.formEventHandler_&&this.formEventHandler_.removeListener(),this.formEventHandler_=X(document,"submit",this.formSelector,this.onDocSubmitDelegate_.bind(this),this.allowPreventNavigate)}},{key:"setIgnoreQueryStringFromRoutePath",value:function(e){this.ignoreQueryStringFromRoutePath=e}},{key:"setLinkSelector",value:function(e){this.linkSelector=e,this.linkEventHandler_&&this.linkEventHandler_.removeListener(),this.linkEventHandler_=X(document,"click",this.linkSelector,this.onDocClickDelegate_.bind(this),this.allowPreventNavigate)}},{key:"setLoadingCssClass",value:function(e){this.loadingCssClass=e}},{key:"setUpdateScrollPosition",value:function(e){this.updateScrollPosition=e}},{key:"stopPendingNavigate_",value:function(){this.pendingNavigate=null}},{key:"syncScrollPositionSyncThenAsync_",value:function(){var e=this,t=pe.window.history.state;if(t){var n=t.scrollTop,r=t.scrollLeft,i=function(){e.updateScrollPosition&&pe.window.scrollTo(r,n)};return new Promise(function(e){i(),setTimeout(function(){i(),e()},0)})}}},{key:"updateHistory_",value:function(e,t,n,r){var i=pe.window.location.href;n&&(n.referrer=i),r?pe.window.history.replaceState(n,e,t):pe.window.history.pushState(n,e,t),Xe.setReferrer(i);var a=pe.document.querySelector("title");a?a.innerHTML=e:pe.document.title=e}}]),Lt);function Lt(){a(this,Lt);var e=s(this,(Lt.__proto__||Object.getPrototypeOf(Lt)).call(this));return e.activeScreen=null,e.activePath=null,e.allowPreventNavigate=!0,e.basePath="",e.browserPathBeforeNavigate=Xe.getCurrentBrowserPathWithoutHash(),e.captureScrollPositionFromScrollEvent=!0,e.defaultTitle=pe.document.title,e.formSelector='form[enctype="multipart/form-data"]:not([data-senna-off])',e.ignoreQueryStringFromRoutePath=!1,e.linkSelector='a:not([data-senna-off]):not([target="_blank"])',e.loadingCssClass="senna-loading",e.nativeScrollRestorationSupported="scrollRestoration"in pe.window.history,e.navigationStrategy=Pt,e.isNavigationPending=!1,e.pendingNavigate=null,e.popstateScrollLeft=0,e.popstateScrollTop=0,e.redirectPath=null,e.routes=[],e.scheduledNavigationQueue=[],e.screens={},e.skipLoadPopstate=!1,e.surfaces={},e.updateScrollPosition=!0,e.appEventHandlers_=new lt,e.appEventHandlers_.add(J(pe.window,"scroll",Xe.debounce(e.onScroll_.bind(e),100)),J(pe.window,"load",e.onLoad_.bind(e)),J(pe.window,"popstate",e.onPopstate_.bind(e))),e.on("startNavigate",e.onStartNavigate_),e.on("beforeNavigate",e.onBeforeNavigate_),e.on("beforeNavigate",e.onBeforeNavigateDefault_,!0),e.on("beforeUnload",e.onBeforeUnloadDefault_),e.setLinkSelector(e.linkSelector),e.setFormSelector(e.formSelector),e.maybeOverloadBeforeUnload_(),e}function Tt(){a(this,Tt)}Tt.INVALID_STATUS="Invalid status code",Tt.REQUEST_ERROR="Request error",Tt.REQUEST_TIMEOUT="Request timeout",Tt.REQUEST_PREMATURE_TERMINATION="Request terminated prematurely";var Ct=(i(Ot,kt),t(Ot,[{key:"assertValidResponseStatusCode",value:function(e){if(!this.isValidResponseStatusCode(e)){var t=new Error(Tt.INVALID_STATUS);throw t.invalidStatus=!0,t.statusCode=e,t}}},{key:"beforeUpdateHistoryPath",value:function(e){var t=this.getRequestPath();return t&&t!==e?t:e}},{key:"beforeUpdateHistoryState",value:function(e){return e.senna&&e.form&&e.redirectPath===e.path?null:e}},{key:"formatLoadPath",value:function(e){var t=new We(e);return t.setHostname(pe.window.location.hostname),t.setProtocol(pe.window.location.protocol),pe.window.location.port&&t.setPort(pe.window.location.port),Xe.isIeOrEdge()&&this.httpMethod===Ot.GET?t.makeUnique().toString():t.toString()}},{key:"getHttpHeaders",value:function(){return this.httpHeaders}},{key:"getHttpMethod",value:function(){return this.httpMethod}},{key:"getRequestPath",value:function(){var e=this.getRequest();if(e){var t=e.url,n=this.maybeExtractResponseUrlFromRequest(e);return n&&(t=n),Xe.isIeOrEdge()&&this.httpMethod===Ot.GET&&(t=new We(t).removeUnique().toString()),Xe.getUrlPath(t)}return null}},{key:"getRequest",value:function(){return this.request}},{key:"getTimeout",value:function(){return this.timeout}},{key:"isValidResponseStatusCode",value:function(e){return 200<=e&&e<=399}},{key:"getFormData",value:function(e,t){var n=new FormData(e);return this.maybeAppendSubmitButtonValue_(n,t),n}},{key:"load",value:function(e){var n=this,t=this.getCache();if(be(t))return Promise.resolve(t);var r=null,i=this.httpMethod,a=new Headers;Object.keys(this.httpHeaders).forEach(function(e){a.append(e,n.httpHeaders[e])}),pe.capturedFormElement&&(this.addSafariXHRPolyfill(),r=this.getFormData(pe.capturedFormElement,pe.capturedFormButtonElement),i=Ot.POST,Xe.isIeOrEdge()&&a.append("If-None-Match",'"0"'));var o=this.formatLoadPath(e),s=new Request(o,{body:r,credentials:"include",headers:a,method:i});return this.setRequest(s),Promise.race([fetch(s).then(function(e){return n.removeSafariXHRPolyfill(),n.assertValidResponseStatusCode(e.status),e.text()}).then(function(e){return i===Ot.GET&&n.isCacheable()&&n.addCache(e),e}),new Promise(function(e,t){setTimeout(function(){return t(new Error(Tt.REQUEST_TIMEOUT))},n.timeout)})]).catch(function(e){switch(n.removeSafariXHRPolyfill(),e.message){case Tt.REQUEST_TIMEOUT:e.timeout=!0;break;case Tt.REQUEST_ERROR:e.requestError=!0;break;case Tt.REQUEST_PREMATURE_TERMINATION:e.requestError=!0,e.requestPrematureTermination=!0}throw e})}},{key:"maybeAppendSubmitButtonValue_",value:function(e,t){t&&t.name&&e.append(t.name,t.value)}},{key:"maybeExtractResponseUrlFromRequest",value:function(e){return e.headers.get(Ot.X_REQUEST_URL_HEADER)}},{key:"addSafariXHRPolyfill",value:function(){if(pe.capturedFormElement&&Xe.isSafari())for(var e=pe.capturedFormElement.querySelectorAll('input[type="file"]:not([disabled])'),t=0;t<e.length;t++){var n=e[t];if(0<n.files.length)return;n.setAttribute("data-safari-temp-disabled","true"),n.setAttribute("disabled","")}}},{key:"removeSafariXHRPolyfill",value:function(){if(pe.capturedFormElement&&Xe.isSafari())for(var e=pe.capturedFormElement.querySelectorAll('input[type="file"][data-safari-temp-disabled]'),t=0;t<e.length;t++){var n=e[t];n.removeAttribute("data-safari-temp-disabled"),n.removeAttribute("disabled")}}},{key:"setHttpHeaders",value:function(e){this.httpHeaders=e}},{key:"setHttpMethod",value:function(e){this.httpMethod=e.toLowerCase()}},{key:"setRequest",value:function(e){this.request=e}},{key:"setTimeout",value:function(e){this.timeout=e}}]),Ot);function Ot(){a(this,Ot);var e=s(this,(Ot.__proto__||Object.getPrototypeOf(Ot)).call(this));return e.cacheable=!0,e.httpHeaders={"X-PJAX":"true","X-Requested-With":"XMLHttpRequest"},e.httpMethod=Ot.GET,e.request=null,e.timeout=3e4,e}Ct.GET="get",Ct.POST="post",Ct.X_REQUEST_URL_HEADER="X-Request-URL";var Rt=(i(Nt,Ct),t(Nt,[{key:"activate",value:function(){o(Nt.prototype.__proto__||Object.getPrototypeOf(Nt.prototype),"activate",this).call(this),this.releaseVirtualDocument(),this.pendingStyles=null}},{key:"allocateVirtualDocumentForContent",value:function(e){this.virtualDocument||(this.virtualDocument=pe.document.createElement("html")),this.copyNodeAttributesFromContent_(e,this.virtualDocument),this.virtualDocument.innerHTML=e}},{key:"appendStyleIntoDocument_",value:function(e){if(K(e,Nt.selectors.stylesTemporary)&&this.pendingStyles.push(e),e.id){var t=pe.document.getElementById(e.id);if(t)return void t.parentNode.insertBefore(e,t.nextSibling)}pe.document.head.appendChild(e)}},{key:"assertSameBodyIdInVirtualDocument",value:function(){var e=this.virtualDocument.querySelector("body");pe.document.body.id||(pe.document.body.id="senna_surface_"+Ee()),e&&(e.id=pe.document.body.id)}},{key:"copyNodeAttributesFromContent_",value:function(e,t){e=(e=e.replace(/[<]\s*html/gi,"<senna")).replace(/\/html\s*\>/gi,"/senna>");var n=void 0;(n=Xe.isIe()?pe.document.createRange().createContextualFragment(e).querySelector("senna"):(t.innerHTML=e,t.querySelector("senna")))&&(Xe.clearNodeAttributes(t),Xe.copyNodeAttributes(n,t))}},{key:"disposeInternal",value:function(){this.disposePendingStyles(),o(Nt.prototype.__proto__||Object.getPrototypeOf(Nt.prototype),"disposeInternal",this).call(this)}},{key:"disposePendingStyles",value:function(){this.pendingStyles&&Xe.removeElementsFromDocument(this.pendingStyles)}},{key:"evaluateScripts",value:function(e){var t=this;return this.evaluateTrackedResources_(he.runScriptsInElement,Nt.selectors.scripts,Nt.selectors.scriptsTemporary,Nt.selectors.scriptsPermanent).then(function(){return o(Nt.prototype.__proto__||Object.getPrototypeOf(Nt.prototype),"evaluateScripts",t).call(t,e)})}},{key:"evaluateStyles",value:function(e){var t=this;return this.pendingStyles=[],this.evaluateTrackedResources_(ve.runStylesInElement,Nt.selectors.styles,Nt.selectors.stylesTemporary,Nt.selectors.stylesPermanent,this.appendStyleIntoDocument_.bind(this)).then(function(){return o(Nt.prototype.__proto__||Object.getPrototypeOf(Nt.prototype),"evaluateStyles",t).call(t,e)})}},{key:"evaluateFavicon_",value:function(){var t=this,n=this.virtualQuerySelectorAll_(Nt.selectors.favicon),r=this.querySelectorAll_(Nt.selectors.favicon);return new Promise(function(e){Xe.removeElementsFromDocument(r),t.runFaviconInElement_(n).then(function(){return e()})})}},{key:"evaluateTrackedResources_",value:function(t,e,n,r,i){var a=this,o=this.virtualQuerySelectorAll_(e),s=this.querySelectorAll_(n);this.querySelectorAll_(r).forEach(function(e){var t=a.getResourceKey_(e);t&&(Nt.permanentResourcesInDoc[t]=!0)});var u=W();return o.forEach(function(e){var t=a.getResourceKey_(e);Nt.permanentResourcesInDoc[t]||u.appendChild(e),t&&K(e,r)&&(Nt.permanentResourcesInDoc[t]=!0)}),new Promise(function(e){t(u,function(){Xe.removeElementsFromDocument(s),e()},i)})}},{key:"flip",value:function(e){var t=this;return o(Nt.prototype.__proto__||Object.getPrototypeOf(Nt.prototype),"flip",this).call(this,e).then(function(){Xe.clearNodeAttributes(pe.document.documentElement),Xe.copyNodeAttributes(t.virtualDocument,pe.document.documentElement),t.evaluateFavicon_(),t.updateMetaTags_()})}},{key:"updateMetaTags_",value:function(){var e=this.querySelectorAll_("meta"),t=this.metas;e&&(Xe.removeElementsFromDocument(e),t&&t.forEach(function(e){return pe.document.head.appendChild(e)}))}},{key:"getResourceKey_",value:function(e){return e.id||e.href||e.src||""}},{key:"getSurfaceContent",value:function(e){var t=this.virtualDocument.querySelector("#"+e);if(t){var n=t.querySelector("#"+e+"-"+St.DEFAULT);return n?n.innerHTML:t.innerHTML}}},{key:"getTitleSelector",value:function(){return this.titleSelector}},{key:"load",value:function(e){var t=this;return o(Nt.prototype.__proto__||Object.getPrototypeOf(Nt.prototype),"load",this).call(this,e).then(function(e){return t.allocateVirtualDocumentForContent(e),t.resolveTitleFromVirtualDocument(),t.resolveMetaTagsFromVirtualDocument(),t.assertSameBodyIdInVirtualDocument(),Xe.isIe()&&t.makeTemporaryStylesHrefsUnique_(),e})}},{key:"makeTemporaryStylesHrefsUnique_",value:function(){var t=this;this.virtualQuerySelectorAll_(Nt.selectors.stylesTemporary).forEach(function(e){return t.replaceStyleAndMakeUnique_(e)})}},{key:"replaceStyleAndMakeUnique_",value:function(e){if(e.href){var t=pe.document.createElement(e.tagName);e.href=new We(e.href).makeUnique().toString(),Xe.copyNodeAttributes(e,t),e.parentNode.replaceChild(t,e),e.disabled=!0}}},{key:"runFaviconInElement_",value:function(t){return new Promise(function(e){t.forEach(function(e){return document.head.appendChild(Xe.isIe()?e:Xe.setElementWithRandomHref(e))}),e()})}},{key:"virtualQuerySelectorAll_",value:function(e){return Array.prototype.slice.call(this.virtualDocument.querySelectorAll(e))}},{key:"querySelectorAll_",value:function(e){return Array.prototype.slice.call(pe.document.querySelectorAll(e))}},{key:"releaseVirtualDocument",value:function(){this.virtualDocument=null}},{key:"resolveTitleFromVirtualDocument",value:function(){var e=this.virtualDocument.querySelector(this.titleSelector);e&&this.setTitle(e.textContent.trim())}},{key:"resolveMetaTagsFromVirtualDocument",value:function(){var e=this.virtualQuerySelectorAll_(this.metaTagsSelector);e&&this.setMetas(e)}},{key:"setTitleSelector",value:function(e){this.titleSelector=e}}]),Nt);function Nt(){a(this,Nt);var e=s(this,(Nt.__proto__||Object.getPrototypeOf(Nt)).call(this));return e.metaTagsSelector="meta",e.titleSelector="title",e}var Ht=':not([rel="Shortcut Icon"]):not([rel="shortcut icon"]):not([rel="icon"]):not([href$="favicon.icon"])';function It(){a(this,It);var e=s(this,(It.__proto__||Object.getPrototypeOf(It)).call(this));return e.app=null,e.baseElement=null,e}Rt.selectors={favicon:'link[rel="Shortcut Icon"],link[rel="shortcut icon"],link[rel="icon"],link[href$="favicon.icon"]',scripts:"script[data-senna-track]",scriptsPermanent:'script[data-senna-track="permanent"]',scriptsTemporary:'script[data-senna-track="temporary"]',styles:"style[data-senna-track],link[data-senna-track]"+Ht,stylesPermanent:'style[data-senna-track="permanent"],link[data-senna-track="permanent"]'+Ht,stylesTemporary:'style[data-senna-track="temporary"],link[data-senna-track="temporary"]'+Ht},Rt.permanentResourcesInDoc={};var xt=new(i(It,He),t(It,[{key:"handle",value:function(){if(!Pe(this.baseElement))throw new Error("Senna data attribute handler base element not set or invalid, try setting a valid element that contains a `data-senna` attribute.");if(this.baseElement.hasAttribute(Je)){if(this.app)throw new Error("Senna app was already initialized.");console.log("Senna initialized from data attribute."),this.app=new At,this.maybeAddRoutes_(),this.maybeAddSurfaces_(),this.maybeSetBasePath_(),this.maybeSetLinkSelector_(),this.maybeSetLoadingCssClass_(),this.maybeSetUpdateScrollPosition_(),this.maybeDispatch_()}else console.log("Senna was not initialized from data attributes. In order to enable its usage from data attributes try setting in the base element, e.g. `<body data-senna>`.")}},{key:"disposeInternal",value:function(){this.app&&this.app.dispose()}},{key:"getApp",value:function(){return this.app}},{key:"getBaseElement",value:function(){return this.baseElement}},{key:"maybeAddRoutes_",value:function(){var t=this;this.querySelectorAllAsArray_('link[rel="senna-route"]').forEach(function(e){return t.maybeParseLinkRoute_(e)}),this.app.hasRoutes()||(this.app.addRoutes(new yt(/.*/,Rt)),console.log("Senna can't find route elements, adding default."))}},{key:"maybeAddSurfaces_",value:function(){var t=this,e="["+et+"]";this.querySelectorAllAsArray_(e).forEach(function(e){t.updateElementIdIfSpecialSurface_(e),t.app.addSurfaces(e.id)})}},{key:"maybeDispatch_",value:function(){this.baseElement.hasAttribute(Ze)&&this.app.dispatch()}},{key:"maybeParseLinkRoute_",value:function(e){var t=new yt(this.maybeParseLinkRoutePath_(e),this.maybeParseLinkRouteHandler_(e));this.app.addRoutes(t),console.log("Senna scanned route "+t.getPath())}},{key:"maybeParseLinkRouteHandler_",value:function(e){var t=e.getAttribute("type");return be(t)&&(t=xe.getObjectByName(t)),t}},{key:"maybeParseLinkRoutePath_",value:function(e){var t=e.getAttribute("href");return be(t)&&0===t.indexOf("regex:")&&(t=new RegExp(t.substring(6))),t}},{key:"maybeSetBasePath_",value:function(){var e=this.baseElement.getAttribute(Ye);be(e)&&(this.app.setBasePath(e),console.log("Senna scanned base path "+e))}},{key:"maybeSetLinkSelector_",value:function(){var e=this.baseElement.getAttribute(Ge);be(e)&&(this.app.setLinkSelector(e),console.log("Senna scanned link selector "+e))}},{key:"maybeSetLoadingCssClass_",value:function(){var e=this.baseElement.getAttribute(Ke);be(e)&&(this.app.setLoadingCssClass(e),console.log("Senna scanned loading css class "+e))}},{key:"maybeSetUpdateScrollPosition_",value:function(){var e=this.baseElement.getAttribute(tt);be(e)&&("false"===e?this.app.setUpdateScrollPosition(!1):this.app.setUpdateScrollPosition(!0),console.log("Senna scanned update scroll position "+e))}},{key:"querySelectorAllAsArray_",value:function(e){return Array.prototype.slice.call(pe.document.querySelectorAll(e))}},{key:"updateElementIdIfSpecialSurface_",value:function(e){e.id||e!==pe.document.body||(e.id="senna_surface_"+Ee())}},{key:"setBaseElement",value:function(e){this.baseElement=e}}]),It);pe.document.addEventListener("DOMContentLoaded",function(){xt.setBaseElement(pe.document.body),xt.handle()});e.default=At,e.dataAttributeHandler=xt,e.utils=Xe,e.App=At,e.HtmlScreen=Rt,e.Route=yt,e.RequestScreen=Ct,e.Screen=kt,e.version="<%= version %>",Object.defineProperty(e,"__esModule",{value:!0})});
$(document).ready(function(){$(window).on("scroll",function(){if(0<$("div.side-icons").length){var t=$(".side-icons").offset().top-10,e=$(".single-content").offset().top,o=$(".comments").offset().top;screen.width<980?additional=50:additional=190,e<t&&t+additional<o?($(".side-icons").removeClass("transparent"),$(".side-icons").addClass("solid"),$(".side-icons .icon-item").css("cursor","pointer"),click_share=!0):(additional,$(".side-icons").addClass("transparent"),$(".side-icons").removeClass("solid"),$(".side-icons .icon-item").css("cursor","default"),click_share=!1)}})});var currentURL=window.location.protocol+"/"+window.location.host+window.location.pathname;function windowPopup(t,e,o){var i=screen.width/2-e/2,n=screen.height/2-o/2;window.open(t,"","menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width="+e+",height="+o+",top="+n+",left="+i)}$(document).on("click",".share-to-tw",function(t){1==click_share&&(t.preventDefault(),title=$(".parent-title a").text()+" "+$(".title").text(),tweetUrl="https://twitter.com/intent/tweet/?text="+title+"&url="+encodeURI(currentURL),windowPopup(tweetUrl,500,300))}),$(document).on("click",".share-to-fb",function(t){1==click_share&&(t.preventDefault(),windowPopup($(this).attr("data-share"),500,300))});